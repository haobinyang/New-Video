{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7e02","webpack:///./src/components/editor/Export.vue?681f","webpack:///./src/components/editor/Player.vue?3b3c","webpack:///./src/App.vue?16ae","webpack:///./src/components/editor/Index.vue?5af5","webpack:///./src/components/editor/SideMenu.vue?ac10","webpack:///./src/utils/event-bus.js","webpack:///src/components/editor/SideMenu.vue","webpack:///./src/components/editor/SideMenu.vue?1992","webpack:///./src/components/editor/SideMenu.vue","webpack:///./src/components/editor/Player.vue?304a","webpack:///./src/constants/common.js","webpack:///./src/classes/element.js","webpack:///./src/classes/shader.js","webpack:///./src/effects/no_effect.js","webpack:///./src/effects/gray.js","webpack:///./src/effects/index.js","webpack:///./src/classes/video.js","webpack:///./src/classes/image.js","webpack:///./src/classes/text.js","webpack:///./src/classes/audio.js","webpack:///./src/transitions/morph.js","webpack:///./src/transitions/dreamy.js","webpack:///./src/transitions/fade.js","webpack:///./src/transitions/index.js","webpack:///./src/classes/transition.js","webpack:///./src/svgs/plunging.js","webpack:///./src/svgs/index.js","webpack:///./src/classes/svg.js","webpack:///./src/classes/painter.js","webpack:///./src/classes/lottie.js","webpack:///./src/classes/player.js","webpack:///./src/components/editor/Export.vue?7442","webpack:///./src/utils/media.js","webpack:///src/components/editor/Export.vue","webpack:///./src/components/editor/Export.vue?4717","webpack:///./src/components/editor/Export.vue","webpack:///./src/utils/tool.js","webpack:///./src/utils/common.js","webpack:///src/components/editor/Player.vue","webpack:///./src/components/editor/Player.vue?8118","webpack:///./src/components/editor/Player.vue","webpack:///./src/components/editor/TimeLine.vue?f0da","webpack:///./src/components/editor/Anchor.vue?050b","webpack:///src/components/editor/Anchor.vue","webpack:///./src/components/editor/Anchor.vue?96b1","webpack:///./src/components/editor/Anchor.vue","webpack:///src/components/editor/TimeLine.vue","webpack:///./src/components/editor/TimeLine.vue?ecc2","webpack:///./src/components/editor/TimeLine.vue","webpack:///./src/components/editor/Assets.vue?530f","webpack:///src/components/editor/Assets.vue","webpack:///./src/components/editor/Assets.vue?4298","webpack:///./src/components/editor/Assets.vue","webpack:///src/components/editor/Index.vue","webpack:///./src/components/editor/Index.vue?a1ad","webpack:///./src/components/editor/Index.vue","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/components/editor/Assets.vue?28a9","webpack:///./src/components/editor/Index.vue?2bfb","webpack:///./src/components/editor/Anchor.vue?d7a1","webpack:///./src/components/editor/TimeLine.vue?8617","webpack:///./src/components/editor/SideMenu.vue?aa80","webpack:///./src/components/editor/TimeLine.vue?e656","webpack:///./src/components/editor/Assets.vue?0e40","webpack:///./src/components/editor/Index.vue?bb9e"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","staticClass","on","exportClick","_v","_l","item","class","currentTab","$event","itemClick","domProps","_s","icon","label","EventBus","Vue","menu","MENU","mounted","$emit","$on","methods","component","ref","playButtonClick","isPlaying","time","player","_e","CardWidth","WidthPerSecond","ElementType","freeze","VIDEO","AUDIO","IMAGE","TEXT","SVG","TRANSITION","LOTTIE","FitType","FILL","CONTAIN","COVER","EffectType","NO_EFFECT","BLUR","GRAY","TransitionType","MORPH","DREAMY","FADE","OverlayType","PLUNGING","DRAG_STATUS","UNKNOWN","DRAGGING","DRAG_OVER","TRANSITION_UNKNOWN","TRANSITION_DRAGGING","TRANSITION_DRAG_OVER","Element","config","assign","isAttachToPainter","sprite","isStart","zIndex","isManual","painter","add","id","remove","getColorFunction","fitType","ratio","Shader","vertexTemplate","fragTemplate","effect","elementRatio","colorFun","fromFitType","fromEffect","fromRatio","toFitType","toEffect","toRatio","transition","fromColorFun","toColorFun","noEffect","uniforms","fragment","texName","funName","gray","effectMap","effects","type","Video","initRender","setPlaybackRate","videoWidth","width","videoHeight","height","texture","originEffect","geometry","THREE","PlaneGeometry","material","ShaderMaterial","tex","vertexShader","GetVertex","fragmentShader","GetEffectFragment","uniformsNeedUpdate","transparent","Mesh","startTime","endTime","duration","customDuration","video","newPlaybackRate","getPlaybackRate","Math","abs","playbackRate","paused","play","pause","visible","currentTime","newCurrentTime","setCurrentTime","isInRange","correctVideoCurrentTime","addToPainter","render","removeFromPainter","updateShader","position","z","Image","imageWidth","imageHeight","Text","Audio","morph","strength","dreamy","fade","transitionMap","transitions","Transition","Promise","resolve","then","fromId","toId","from","getElementById","to","fromWidth","fromHeight","fromTexture","toWidth","toHeight","toTexture","fromUniforms","fromFragment","toUniforms","toFragment","transitionUniforms","transitionFragment","progress","GetTransitionFragment","plunging","easeType","overlayMap","overlays","svgToCanvas","svg","canvas","canvasContext","image","onload","clearRect","drawImage","src","trim","Svg","initCanvas","document","createElement","context","getContext","MeshBasicMaterial","map","CanvasTexture","func","needsUpdate","Painter","scene","Scene","camera","OrthographicCamera","renderer","WebGLRenderer","preserveDrawingBuffer","antialias","setPixelRatio","setSize","maxAnisotropy","capabilities","getMaxAnisotropy","selectedObject","getObjectByName","domElement","Lottie","animation","lottie","container","goToAndStop","Player","elements","onCurrentTimeChange","onEnd","tickFun","tick","element","updateDuration","forEach","find","indexOf","includes","updateZIndex","playing","tickReq","requestAnimationFrame","renderFrame","tickTime","performance","now","interval","ceil","cancelAnimationFrame","sort","a","b","len","appendChild","getDomElement","_m","staticStyle","getMediaInfo","file","arrayBuffer","worker","Worker","postMessage","onmessage","e","size","extractVideoInMP4","sleep","ms","setTimeout","getImageData","toBlob","blob","exportAsVideo","fileName","fps","frames","imageData","downloadFile","URL","createObjectURL","fileURL","ActiveXObject","execCommand","newWindow","open","close","save","href","target","download","navigator","userAgent","toLowerCase","match","search","location","evt","MouseEvent","dispatchEvent","webkitURL","revokeObjectURL","props","loadVideo","Blob","loop","addEventListener","VideoTexture","console","error","loadImage","TextureLoader","load","loadLottie","path","fetch","lottieRes","json","lottieJson","style","body","loadAnimation","autoplay","animationData","uniqId","random","toString","substr","assetToElementData","naturalWidth","naturalHeight","geneTransitionInfo","element1","element2","halfDuration","geneElementInfo","offsetInDragElement","offsetInDropZone","elementData","leftWidth","x","max","xToTime","getInsertIndex","isIntersect","s1","e1","s2","e2","solveTimeConfict","timeLineElementsToPlayerElements","filter","flat","getDuration","playerElements","msToTime","msInInt","round","leftMs","floor","leftS","leftM","h","padStart","components","exporting","computed","attachTo","$refs","addElement","removeElement","update","scrollWidth","timeLineClick","Array","index","getClasses","dropZoneMouseOver","subItem","index2","getElementClasses","getElementStyle","elementClick","isAdjacent","getTransitionClasses","getTransitionStyle","left","list","overIndex","status","transitionId","offsetX","offsetY","activeId","itemIndex","findOverElementIndex","dropZones","addTransition","items","element1Id","min","inputFile","assets","mouseDown","mouseUp","shiftX","shiftY","selectedAsset","isTranscode","media","clientX","getBoundingClientRect","clientY","top","moveAt","pageX","pageY","mouseMove","hidden","elemBelow","closest","SideMenu","Editor","productionTip","App","$mount"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,IAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,kBAEjBM,K,6ECvJT,W,oCCAA,W,oCCAA,W,qJCAI,EAAS,WAAa,IAAIyC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,QAAQ,CAACF,EAAG,WAAW,IACzIG,EAAkB,GCDlB,EAAS,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,UAAU,CAACJ,EAAG,aAAaA,EAAG,MAAM,CAACI,YAAY,SAAS,CAACJ,EAAG,MAAM,CAACI,YAAY,qBAAqB,CAACJ,EAAG,MAAM,CAACI,YAAY,WAAW,CAACJ,EAAG,MAAM,CAACI,YAAY,SAASJ,EAAG,SAAS,CAACI,YAAY,gBAAgBC,GAAG,CAAC,MAAQT,EAAIU,cAAc,CAACV,EAAIW,GAAG,cAAcP,EAAG,MAAM,CAACI,YAAY,OAAO,CAACJ,EAAG,UAAUA,EAAG,WAAW,GAAGA,EAAG,cAAc,IAAI,IACxc,EAAkB,GCDlB,EAAS,WAAa,IAAIJ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,aAAa,CAACJ,EAAG,MAAM,CAACI,YAAY,QAAQ,CAACR,EAAIY,GAAIZ,EAAQ,MAAE,SAASa,GAAM,OAAOT,EAAG,MAAM,CAACd,IAAIuB,EAAK7B,MAAM8B,MAAM,CAAC,YAAaD,EAAK7B,QAAUgB,EAAIe,WAAa,SAAW,IAAIN,GAAG,CAAC,MAAQ,SAASO,GAAQ,OAAOhB,EAAIiB,UAAUJ,EAAK7B,UAAU,CAACoB,EAAG,MAAM,CAACI,YAAY,SAASJ,EAAG,MAAM,CAACI,YAAY,OAAOU,SAAS,CAAC,UAAYlB,EAAImB,GAAGN,EAAKO,SAAShB,EAAG,OAAO,CAACJ,EAAIW,GAAGX,EAAImB,GAAGN,EAAKQ,eAAcjB,EAAG,IAAI,CAACI,YAAY,WAAWF,MAAM,CAAC,KAAO,0BAA0B,CAACN,EAAIW,GAAG,SAAS,MAChlB,EAAkB,GCATW,EAAW,IAAIC,OCmB5B,gOACA,sWACA,qVACA,yVACA,GACA,CAAE,MAAF,KAAE,MAAF,MAAE,KAAF,GACA,CAAE,MAAF,KAAE,MAAF,QAAE,KAAF,GACA,CAAE,MAAF,KAAE,MAAF,cAAE,KAAF,GACA,CAAE,MAAF,KAAE,MAAF,WAAE,KAAF,GACA,CAAE,MAAF,SAAE,MAAF,SAAE,KAAF,IAEA,GACEpF,KADF,WAEI,MAAO,CACLqF,KAAMC,EACNV,WAAYU,EAAK,GAAGzC,QAGxB0C,QAPF,WAOA,WACIJ,EAASK,MAAM,YAAa1B,KAAKc,YACjCO,EAASM,IAAI,mBAAmB,WAC9B,EAAN,uBAGEC,QAAS,CACPZ,UADJ,SACA,GACMhB,KAAKc,WAAa/B,EAClBsC,EAASK,MAAM,YAAa3C,MC/C+T,I,wBCQ7V8C,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,QCnBX,EAAS,WAAa,IAAI9B,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,aAAa,CAACJ,EAAG,MAAM,CAACI,YAAY,UAAU,CAACJ,EAAG,MAAM,CAAC2B,IAAI,iBAAiBvB,YAAY,UAAUJ,EAAG,MAAM,CAACI,YAAY,YAAY,CAACJ,EAAG,MAAM,CAACI,YAAY,cAAcC,GAAG,CAAC,MAAQT,EAAIgC,kBAAkB,CAAGhC,EAAIiC,UAAwd7B,EAAG,MAAM,CAACE,MAAM,CAAC,MAAQ,KAAK,OAAS,KAAK,QAAU,cAAc,CAACF,EAAG,OAAO,CAACE,MAAM,CAAC,EAAI,KAAK,EAAI,IAAI,MAAQ,IAAI,OAAS,KAAK,GAAK,IAAI,KAAO,kBAAkBF,EAAG,OAAO,CAACE,MAAM,CAAC,EAAI,IAAI,EAAI,IAAI,MAAQ,IAAI,OAAS,KAAK,GAAK,IAAI,KAAO,oBAA7rBF,EAAG,MAAM,CAACE,MAAM,CAAC,MAAQ,KAAK,OAAS,KAAK,QAAU,cAAc,CAACF,EAAG,OAAO,CAACE,MAAM,CAAC,EAAI,uVAAuV,KAAO,sBAA0RF,EAAG,MAAM,CAACI,YAAY,QAAQ,CAACR,EAAIW,GAAGX,EAAImB,GAAGnB,EAAIkC,aAAclC,EAAa,UAAEI,EAAG,gBAAgB,CAACE,MAAM,CAAC,OAASN,EAAImC,UAAUnC,EAAIoC,MAAM,IAC9qC,EAAkB,G,sECDTC,G,sEAAY,KACZC,EAAiB,GAEjBC,EAAc3F,OAAO4F,OAAO,CACvCC,MAAO,QACPC,MAAO,QACPC,MAAO,QACPC,KAAM,OACNC,IAAK,MACLC,WAAY,aACZC,OAAQ,WAGGC,EAAUpG,OAAO4F,OAAO,CACnCS,KAAM,EACNC,QAAS,EACTC,MAAO,IAGIC,EAAaxG,OAAO4F,OAAO,CACtCa,UAAW,EACXC,KAAM,EACNC,KAAM,IAGKC,EAAiB5G,OAAO4F,OAAO,CAC1CiB,MAAO,EACPC,OAAQ,EACRC,KAAM,IAGKC,EAAchH,OAAO4F,OAAO,CACvCqB,SAAU,IAGCC,EAAclH,OAAO4F,OAAO,CACvCuB,SAAU,EACVC,SAAU,EACVC,UAAW,EACXC,mBAAoB,EACpBC,oBAAqB,EACrBC,qBAAsB,I,wECzCXC,EAAb,WACE,WAAYC,EAAQnC,GAAQ,uBAC1BvF,OAAO2H,OAAOtE,KAAMqE,GACpBrE,KAAKkC,OAASA,EACdlC,KAAKuE,mBAAoB,EACzBvE,KAAKwE,OAAS,KACdxE,KAAKyE,SAAU,EANnB,mDASE,SAAaC,GACX1E,KAAK0E,OAASA,IAVlB,iCAaE,SAAoBC,MAbtB,mBAgBE,cAhBF,0BAmBE,WACO3E,KAAKuE,oBACRvE,KAAKuE,mBAAoB,EACzBvE,KAAKkC,OAAO0C,QAAQC,IAAI7E,KAAKwE,OAAQxE,KAAK8E,OAtBhD,+BA0BE,WACM9E,KAAKuE,oBACPvE,KAAKuE,mBAAoB,EACzBvE,KAAKkC,OAAO0C,QAAQG,OAAO/E,KAAK8E,SA7BtC,K,UCKA,SAASE,EAAiBC,EAASC,GACjC,OAAQD,GACN,KAAKlC,EAAQC,KACX,MAAO,KACT,KAAKD,EAAQE,QACX,0CAAoCiC,EAApC,oBAAqDA,EAArD,eACF,KAAKnC,EAAQG,MACX,0CAAoCgC,EAApC,oBAAqDA,EAArD,gBAIC,I,EAAMC,EAAb,oGACE,WACE,IAAMC,EAAiB,gLAOvB,OAAOA,IATX,yBAYE,WACE,IAAMC,EAAe,uJAOrB,OAAOA,IApBX,+BAuBE,YAIG,QAHDJ,eAGC,MAHSlC,EAAQE,QAGjB,EAFDqC,EAEC,EAFDA,OACAC,EACC,EADDA,aAEMC,EAAWR,EAAiBC,EAASM,GACrCF,EAAe,oGAAH,OAIdC,EAJc,kEAMCE,EAND,8QAiBlB,OAAOH,IA9CX,mCAiDE,YAQG,QAPDI,mBAOC,MAPa1C,EAAQE,QAOrB,EANDyC,EAMC,EANDA,WACAC,EAKC,EALDA,UAKC,IAJDC,iBAIC,MAJW7C,EAAQE,QAInB,EAHD4C,EAGC,EAHDA,SACAC,EAEC,EAFDA,QACAC,EACC,EADDA,WAEMC,EAAehB,EAAiBS,EAAaE,GAC7CM,EAAajB,EAAiBY,EAAWE,GACzCT,EAAe,4JAAH,OAKdK,EALc,mBAMdG,EANc,sEAQCG,EARD,iQAgBCC,EAhBD,8MAuBdF,EAvBc,uFA4BlB,OAAOV,MAxFX,KChBO,SAASa,IACd,MAAO,CACLC,SAAU,GACVC,SAAU,eAACC,EAAD,uDAAW,MAAOC,EAAlB,uDAA4B,SAA5B,6BACDA,EADC,iDAEaD,EAFb,2BCHP,SAASE,IACd,MAAO,CACLJ,SAAU,GACVC,SAAU,eAACC,EAAD,uDAAW,MAAOC,EAAlB,uDAA4B,SAA5B,6BACDA,EADC,uDAEmBD,EAFnB,6HCCd,IAAMG,EAAY7J,OAAO4F,QAAP,KAAA5F,OAAA,OAAAA,CAAA,EACfwG,EAAWC,UAAY8C,GADRvJ,OAAA,OAAAA,CAAA,EAEfwG,EAAWG,KAAOiD,GAFH,IAKH,SAASE,EAAQC,GAC9B,OAAOF,EAAUE,KCFZ,I,EAAMC,EAAb,wDAGE,WAAYtC,EAAQnC,GAAQ,oCAC1B,cAAMmC,EAAQnC,GADY,gDAFb,GAIb,EAAK0E,aACL,EAAKC,kBAHqB,EAH9B,iDASE,WACE,IACSC,EAML9G,KANF+G,MACQC,EAKNhH,KALFiH,OACA3B,EAIEtF,KAJFsF,OACA4B,EAGElH,KAHFkH,QACAjC,EAEEjF,KAFFiF,QALF,EAOIjF,KADFkC,OAAU6E,EANZ,EAMYA,MAAOE,EANnB,EAMmBA,OAEnB,EAA+BR,EAAQnB,GAA/Ba,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,SAClBpG,KAAKmH,aAAe7B,EAEpBtF,KAAKoH,SAAW,IAAIC,MAAMC,cAAcP,EAAOE,GAE/CjH,KAAKuH,SAAW,IAAIF,MAAMG,eAAe,CACvCrB,SAAU,gBACRsB,IAAK,CAAE1I,MAAOmI,GACdhC,MAAO,CAAEnG,MAAOgI,EAAQE,IACrBd,GAELuB,aAAcvC,EAAOwC,YACrBC,eAAgBzC,EAAO0C,kBAAkB,CACvCtC,aAAcuB,EAAaE,EAC3B/B,QAASA,EACTK,OAAQc,MAEV0B,oBAAoB,IAEtB9H,KAAKuH,SAASQ,aAAc,EAE5B/H,KAAKwE,OAAS,IAAI6C,MAAMW,KAAKhI,KAAKoH,SAAUpH,KAAKuH,YAvCrD,6BA0CE,WAEE,IAAQU,EAAiCjI,KAAjCiI,UAAWC,EAAsBlI,KAAtBkI,QAASC,EAAanI,KAAbmI,SACtBC,EAAiBF,EAAUD,EACjC,OAAOE,EAAWC,IA9CtB,6BAiDE,WACE,IAAMC,EAAQrI,KAAKqI,MACbC,EAAkBtI,KAAKuI,kBACzBC,KAAKC,IAAIJ,EAAMK,aAAeJ,IAAoB,OACpDD,EAAMK,aAAeJ,KArD3B,kBAyDE,WACE,IAAMD,EAAQrI,KAAKqI,MACfA,EAAMM,QACRN,EAAMO,SA5DZ,mBAgEE,WACE,oEACA,IAAMP,EAAQrI,KAAKqI,MACdA,EAAMM,QACTN,EAAMQ,UApEZ,kBAwEE,WACE7I,KAAKwE,OAAOsE,SAAU,IAzE1B,kBA4EE,WACE9I,KAAKwE,OAAOsE,SAAU,IA7E1B,8FAiFE,mHACUb,EAAgDjI,KAAhDiI,UAAWf,EAAqClH,KAArCkH,QAAmB6B,EAAkB/I,KAA5BkC,OAAU6G,YAChCL,EAAe1I,KAAKuI,kBACpBS,GAAkBD,EAAcd,GAAaS,EAAe,IAHpE,SAIQxB,EAAQ+B,eAAeD,GAJ/B,gDAjFF,mJAwFE,WAA0BrE,GAA1B,qFACM3E,KAAKkC,OAAOgH,UAAUlJ,MAD5B,qBAEQ2E,EAFR,uBAGM3E,KAAK6I,QAHX,SAIY7I,KAAKmJ,0BAJjB,6BAMMnJ,KAAK4I,OANX,OAQI5I,KAAKyE,SAAU,EACfzE,KAAKoJ,eACLpJ,KAAKqJ,SAVT,wBAYQrJ,KAAKyE,UACPzE,KAAKyE,SAAU,EACfzE,KAAK6I,QACL7I,KAAKsJ,qBAfX,iDAxFF,oFA4GE,WACMtJ,KAAKmH,aAAiBnH,KAAKsF,SA7GnC,oBA0HE,WACEtF,KAAKuJ,eACLvJ,KAAKwE,OAAOgF,SAASC,EAAIzJ,KAAK0E,WA5HlC,GAA2BN,GCJdsF,EAAb,wDAGE,WAAYrF,EAAQnC,GAAQ,oCAC1B,cAAMmC,EAAQnC,GADY,gDAFb,GAIb,EAAK0E,aAFqB,EAH9B,iDAQE,WACE,IACS+C,EAML3J,KANF+G,MACQ6C,EAKN5J,KALFiH,OACA3B,EAIEtF,KAJFsF,OACA4B,EAGElH,KAHFkH,QACAjC,EAEEjF,KAFFiF,QALF,EAOIjF,KADFkC,OAAU6E,EANZ,EAMYA,MAAOE,EANnB,EAMmBA,OAEnB,EAA+BR,EAAQnB,GAA/Ba,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,SAClBpG,KAAKmH,aAAe7B,EAEpBtF,KAAKoH,SAAW,IAAIC,MAAMC,cAAcP,EAAOE,GAE/CjH,KAAKuH,SAAW,IAAIF,MAAMG,eAAe,CACvCrB,SAAU,gBACRsB,IAAK,CAAE1I,MAAOmI,GACdhC,MAAO,CAAEnG,MAAOgI,EAAQE,IACrBd,GAELuB,aAAcvC,EAAOwC,YACrBC,eAAgBzC,EAAO0C,kBAAkB,CACvCtC,aAAcoE,EAAaC,EAC3B3E,QAASA,EACTK,OAAQc,MAEV0B,oBAAoB,IAEtB9H,KAAKuH,SAASQ,aAAc,EAE5B/H,KAAKwE,OAAS,IAAI6C,MAAMW,KAAKhI,KAAKoH,SAAUpH,KAAKuH,YAtCrD,kBAyCE,WACEvH,KAAKwE,OAAOsE,SAAU,IA1C1B,kBA6CE,WACE9I,KAAKwE,OAAOsE,SAAU,IA9C1B,iCAiDE,WACM9I,KAAKkC,OAAOgH,UAAUlJ,OACxBA,KAAKoJ,eACLpJ,KAAKqJ,UAELrJ,KAAKsJ,sBAtDX,0BA0DE,WACMtJ,KAAKmH,aAAiBnH,KAAKsF,SA3DnC,oBA+DE,WACEtF,KAAKuJ,eACLvJ,KAAKwE,OAAOgF,SAASC,EAAIzJ,KAAK0E,WAjElC,GAA2BN,GCFdyF,EAAb,wDACE,WAAYxF,EAAQnC,GAAQ,0CACpBmC,EAAQnC,GAFlB,UAA0BkC,GCAb0F,EAAb,wDACE,WAAYzF,EAAQnC,GAAQ,0CACpBmC,EAAQnC,GAFlB,UAA2BkC,G,UCFpB,SAAS2F,KACd,MAAO,CACL5D,SAAU,CACR6D,SAAU,CAAEjL,MAAO,KAErBqH,SAAU,ycCLP,SAAS6D,KACd,MAAO,CACL9D,SAAU,GACVC,SAAU,kZCHP,SAAS8D,KACd,MAAO,CACL/D,SAAU,GACVC,SAAU,kKCEd,IAAM+D,GAAgBxN,OAAO4F,QAAP,KAAA5F,OAAA,OAAAA,CAAA,EACnB4G,EAAeC,MAAQuG,IADJpN,OAAA,OAAAA,CAAA,EAEnB4G,EAAeE,OAASwG,IAFLtN,OAAA,OAAAA,CAAA,EAGnB4G,EAAeG,KAAOwG,IAHH,IAMP,SAASE,GAAY1D,GAClC,OAAOyD,GAAczD,KCHhB,IAAM2D,GAAb,wDACE,WAAYhG,EAAQnC,GAAQ,oCAC1B,cAAMmC,EAAQnC,GACdoI,QAAQC,UAAUC,MAAK,WACrB,wBAAQtI,EAAR,EAAQA,OAAQuI,EAAhB,EAAgBA,OAAQC,EAAxB,EAAwBA,KACxB,EAAKC,KAAOzI,EAAO0I,eAAeH,GAClC,EAAKI,GAAK3I,EAAO0I,eAAeF,GAChC,EAAK9D,gBANmB,EAD9B,iDAYE,WACE,IAAQ6D,EAAqCzK,KAArCyK,OAAQC,EAA6B1K,KAA7B0K,KAAM3E,EAAuB/F,KAAvB+F,WAAY7D,EAAWlC,KAAXkC,OAC1B6E,EAAkB7E,EAAlB6E,MAAOE,EAAW/E,EAAX+E,OACf,EAMI/E,EAAO0I,eAAeH,GALjBK,EADT,EACE/D,MACQgE,EAFV,EAEE9D,OACQvB,EAHV,EAGEJ,OACS0F,EAJX,EAIE9D,QACSzB,EALX,EAKER,QAEF,EAMI/C,EAAO0I,eAAeF,GALjBO,EADT,EACElE,MACQmE,EAFV,EAEEjE,OACQpB,EAHV,EAGEP,OACS6F,EAJX,EAIEjE,QACStB,EALX,EAKEX,QAEF,EAA2DwB,EAAQf,GAAjD0F,EAAlB,EAAQjF,SAAkCkF,EAA1C,EAAgCjF,SAChC,EAAuDK,EAAQZ,GAA7CyF,EAAlB,EAAQnF,SAAgCoF,EAAxC,EAA8BnF,SAC9B,EAAuEgE,GAAYrE,GAAjEyF,EAAlB,EAAQrF,SAAwCsF,EAAhD,EAAsCrF,SAEtCpG,KAAKoH,SAAW,IAAIC,MAAMC,cAAcP,EAAOE,GAE/CjH,KAAKuH,SAAW,IAAIF,MAAMG,eAAe,CACvCrB,SAAU,8CACRwE,KAAM,CAAE5L,MAAOiM,GACfH,GAAI,CAAE9L,MAAOoM,GACbO,SAAU,CAAE3M,MAAO,GACnBmG,MAAO,CAAEnG,MAAOgI,EAAQE,IACrBmE,GACAE,GACAE,GAEL9D,aAAcvC,EAAOwC,YACrBC,eAAgBzC,EAAOwG,sBAAsB,CAC3ClG,cACAC,WAAY2F,EAAa,OAAQ,cACjC1F,UAAWmF,EAAYC,EACvBnF,YACAC,SAAU0F,EAAW,KAAM,YAC3BzF,QAASmF,EAAUC,EACnBnF,WAAY0F,IAEd3D,oBAAoB,IAEtB9H,KAAKuH,SAASQ,aAAc,EAE5B/H,KAAKwE,OAAS,IAAI6C,MAAMW,KAAKhI,KAAKoH,SAAUpH,KAAKuH,YA3DrD,iCA8DE,WACMvH,KAAKkC,OAAOgH,UAAUlJ,OACxBA,KAAKoJ,eAGLpJ,KAAKqJ,UAELrJ,KAAKsJ,sBArEX,oBA2EE,WACE,IAAQrB,EAAsDjI,KAAtDiI,UAAWC,EAA2ClI,KAA3CkI,QAAmBa,EAAwB/I,KAAlCkC,OAAU6G,YAAe4B,EAAS3K,KAAT2K,KAC/Ce,GAAY3C,EAAcd,IAAcC,EAAUD,GACxDjI,KAAKwE,OAAOgF,SAASC,EAAIkB,EAAKjG,OAAS,EACvC1E,KAAKuH,SAASpB,SAASuF,SAAS3M,MAAQ2M,MA/E5C,GAAgCtH,G,UCTzB,SAASwH,GAAT,GAOJ,IAND3D,EAMC,EANDA,UACAC,EAKC,EALDA,QACAa,EAIC,EAJDA,YAEAhC,GAEC,EAHD8E,SAGC,EAFD9E,OACAE,EACC,EADDA,OAEMyE,GAAY3C,EAAcd,IAAcC,EAAUD,GAAa,IACrE,mQAIkElB,EAJlE,uBAIsFE,EAJtF,gCAIoHyE,EAJpH,kyBCNF,IAAMI,GAAanP,OAAO4F,OAAP5F,OAAA,OAAAA,CAAA,GAChBgH,EAAYC,SAAWgI,KAGX,SAASG,GAASrF,GAC/B,OAAOoF,GAAWpF,GAGb,SAASsF,GAAYC,EAAKC,EAAQC,GACvC,OAAO,IAAI7B,SAAQ,SAACC,GAClB,IAAQxD,EAAkBmF,EAAlBnF,MAAOE,EAAWiF,EAAXjF,OACTmF,EAAQ,IAAI1C,MAClB0C,EAAMrF,MAAQA,EACdqF,EAAMnF,OAASA,EACfmF,EAAMC,OAAS,WACbF,EAAcG,UAAU,EAAG,EAAGvF,EAAOE,GACrCkF,EAAcI,UAAUH,EAAO,EAAG,GAClC7B,KAEF6B,EAAMI,IAAN,6BAAkCP,EAAIQ,WCnBnC,IAAMC,GAAb,wDACE,WAAYrI,EAAQnC,GAAQ,oCAC1B,cAAMmC,EAAQnC,GACd,EAAKyK,aACL,EAAK/F,aAHqB,EAD9B,iDAOE,WACE,MAAsC5G,KAA9BkC,OAAU6E,EAAlB,EAAkBA,MAAOE,EAAzB,EAAyBA,OACzBjH,KAAKkM,OAASU,SAASC,cAAc,UACrC7M,KAAKkM,OAAOnF,MAAQA,EACpB/G,KAAKkM,OAAOjF,OAASA,EACrBjH,KAAK8M,QAAU9M,KAAKkM,OAAOa,WAAW,QAZ1C,wBAeE,WACE,MAAsC/M,KAA9BkC,OAAU6E,EAAlB,EAAkBA,MAAOE,EAAzB,EAAyBA,OAEzBjH,KAAKoH,SAAW,IAAIC,MAAMC,cAAcP,EAAOE,GAE/CjH,KAAKuH,SAAW,IAAIF,MAAM2F,kBAE1BhN,KAAKuH,SAAS0F,IAAM,IAAI5F,MAAM6F,cAAclN,KAAKkM,QACjDlM,KAAKuH,SAASQ,aAAc,EAE5B/H,KAAKwE,OAAS,IAAI6C,MAAMW,KAAKhI,KAAKoH,SAAUpH,KAAKuH,YAzBrD,0FA4BE,kGACMvH,KAAKkC,OAAOgH,UAAUlJ,MAD5B,uBAEIA,KAAKoJ,eAFT,SAGUpJ,KAAKqJ,SAHf,6BAKIrJ,KAAKsJ,oBALT,gDA5BF,sIAqCE,2HAC+EtJ,KAArEkC,OAAU6E,EADpB,EACoBA,MAAOE,EAD3B,EAC2BA,OAAQ8B,EADnC,EACmCA,YAAeoE,EAA6BnN,KAA7BmN,KAAMlF,EAAuBjI,KAAvBiI,UAAWC,EAAYlI,KAAZkI,QAC3D+D,EAAMkB,EAAK,CAAElF,YAAWC,UAASa,cAAahC,QAAOE,WAF7D,SAGQ+E,GAAYC,EAAKjM,KAAKkM,OAAQlM,KAAK8M,SAH3C,OAIE9M,KAAKuH,SAAS0F,IAAIG,aAAc,EAChCpN,KAAKwE,OAAOgF,SAASC,EAAIzJ,KAAK0E,OALhC,gDArCF,8DAAyBN,GCHJiJ,I,qBACnB,WAAYtG,EAAOE,GAAQ,uBAEzBjH,KAAKsN,MAAQ,IAAIjG,MAAMkG,MAEvBvN,KAAKwN,OAAS,IAAInG,MAAMoG,mBAAmB1G,GAAU,EAAGA,EAAQ,EAAGE,EAAS,EAAGA,GAAW,GAAI,IAAM,KAEpGjH,KAAK0N,SAAW,IAAIrG,MAAMsG,cAAc,CACtCC,uBAAuB,EACvBC,WAAW,IAGb7N,KAAK0N,SAASI,cAAc,GAC5B9N,KAAK0N,SAASK,QAAQhH,EAAOE,GAC7BjH,KAAKgO,cAAgBhO,KAAK0N,SAASO,aAAaC,mB,0CAGlD,SAAI1J,EAAQlG,GACVkG,EAAOlG,KAAOA,EACd0B,KAAKsN,MAAMzI,IAAIL,K,oBAGjB,SAAOlG,GACL,IAAM6P,EAAiBnO,KAAKsN,MAAMc,gBAAgB9P,GAClD0B,KAAKsN,MAAMvI,OAAOoJ,K,2BAGpB,WACE,OAAOnO,KAAK0N,SAASW,a,oBAGvB,WACE,IAAOX,EAA2B1N,KAA3B0N,SAAUJ,EAAiBtN,KAAjBsN,MAAOE,EAAUxN,KAAVwN,OACxBE,EAASrE,OAAOiE,EAAOE,O,MC/Bdc,GAAb,wDACE,WAAYjK,EAAQnC,GAAQ,oCAC1B,cAAMmC,EAAQnC,GACd,EAAK0E,aAFqB,EAD9B,iDAME,WACE,MAAsC5G,KAA9BkC,OAAU6E,EAAlB,EAAkBA,MAAOE,EAAzB,EAAyBA,OAEzBjH,KAAKoH,SAAW,IAAIC,MAAMC,cAAcP,EAAOE,GAE/CjH,KAAKuH,SAAW,IAAIF,MAAM2F,kBAE1B,IAAM9F,EAAU,IAAIG,MAAM6F,cAC1BhG,EAAQqH,UAAYvO,KAAKwO,OACzBtH,EAAQkF,MAAQpM,KAAKwO,OAAOC,UAE5BzO,KAAKuH,SAAS0F,IAAM/F,EACpBlH,KAAKuH,SAASQ,aAAc,EAE5B/H,KAAKwE,OAAS,IAAI6C,MAAMW,KAAKhI,KAAKoH,SAAUpH,KAAKuH,YApBrD,0FAuBE,8FACMvH,KAAKkC,OAAOgH,UAAUlJ,OACxBA,KAAKoJ,eACLpJ,KAAKqJ,UAELrJ,KAAKsJ,oBALT,gDAvBF,sIAgCE,sGACoBP,EAA6B/I,KAAvCkC,OAAU6G,YAAed,EAAcjI,KAAdiI,UACjCjI,KAAKwO,OAAOE,YAAY3F,EAAcd,GACtCjI,KAAKuH,SAAS0F,IAAIG,aAAc,EAChCpN,KAAKwE,OAAOgF,SAASC,EAAIzJ,KAAK0E,OAJhC,gDAhCF,8DAA4BN,GCQ5B,SAASyI,GAAcxI,EAAQnC,GAC7B,OAAQmC,EAAOqC,MACb,KAAKpE,EAAYE,MACf,OAAO,IAAImE,EAAMtC,EAAQnC,GAC3B,KAAKI,EAAYI,MACf,OAAO,IAAIgH,EAAMrF,EAAQnC,GAC3B,KAAKI,EAAYO,WACf,OAAO,IAAIwH,GAAWhG,EAAQnC,GAChC,KAAKI,EAAYK,KACf,OAAO,IAAIkH,EAAKxF,EAAQnC,GAC1B,KAAKI,EAAYG,MACf,OAAO,IAAIqH,EAAMzF,EAAQnC,GAC3B,KAAKI,EAAYM,IACf,OAAO,IAAI8J,GAAIrI,EAAQnC,GACzB,KAAKI,EAAYQ,OACf,OAAO,IAAIwL,GAAOjK,EAAQnC,I,IASXyM,G,WAgBnB,cAAqE,WAAvDC,EAAuD,EAAvDA,SAAU7H,EAA6C,EAA7CA,MAAOE,EAAsC,EAAtCA,OAAQ4H,EAA8B,EAA9BA,oBAAqBC,EAAS,EAATA,MAAS,yDAfvD,GAeuD,+BAd1D,GAc0D,+BAb1D,IAa0D,+BAZ3D,GAY2D,4BAX7D,GAW6D,6BAV5D,GAU4D,gCAPzD,GAOyD,8BAN3D,GAM2D,4HACnE9O,KAAK+G,MAAQA,EACb/G,KAAKiH,OAASA,EACdjH,KAAK4E,QAAU,IAAIyI,GAAQtG,EAAOE,GAClCjH,KAAK+O,QAAU/O,KAAKgP,KAAK1P,KAAKU,MAC9BA,KAAK4O,UAAYA,GAAY,IAAI3B,KAAI,SAACgC,GACpC,OAAOpC,GAAcoC,EAAS,MAEhCjP,KAAKkP,iBACLlP,KAAK6O,oBAAsBA,EAC3B7O,KAAK8O,MAAQA,E,qDAGf,WAAiB,WACf9O,KAAKmI,SAAW,EAChBnI,KAAK4O,SAASO,SAAQ,YAAiB,IAAdjH,EAAc,EAAdA,QACnBA,EAAU,EAAKC,WACjB,EAAKA,SAAWD,Q,uBAKtB,SAAU+G,GACR,IAAQhH,EAAuBgH,EAAvBhH,UAAWC,EAAY+G,EAAZ/G,QACnB,OAAOD,GAAajI,KAAK+I,aAAeb,GAAWlI,KAAK+I,c,4BAG1D,SAAejE,GACb,OAAO9E,KAAK4O,SAASQ,MAAK,SAAAH,GAAO,OAAIA,EAAQnK,KAAOA,O,wBAGtD,SAAWmK,GACTjP,KAAK4O,SAAS5R,KAAK6P,GAAcoC,EAASjP,OAC1CA,KAAKkP,iBACLlP,KAAK6I,U,2BAGP,SAAc/D,GACZ,IAAMmK,EAAUjP,KAAK4K,eAAe9F,GAIpC,GAHAmK,EAAQ3F,oBACRtJ,KAAK4O,SAAShR,OAAOoC,KAAK4O,SAASS,QAAQJ,GAAU,GAEjD,CAAC3M,EAAYE,MAAOF,EAAYI,OAAO4M,SAASL,EAAQvI,MAC1D,IAAK,IAAIlK,EAAI,EAAGA,EAAIwD,KAAK4O,SAASlS,OAAQF,IAEtCwD,KAAK4O,SAASpS,GAAGkK,OAASpE,EAAYO,YACtC,CAAC7C,KAAK4O,SAASpS,GAAGiO,OAAQzK,KAAK4O,SAASpS,GAAGkO,MAAM4E,SAASL,EAAQnK,KAElE9E,KAAK4O,SAAShR,OAAOpB,EAAG,GAI9BwD,KAAKkP,iBACLlP,KAAK6I,U,0BAGP,SAAa/D,EAAIJ,GACf,IAAMuK,EAAUjP,KAAK4K,eAAe9F,GACpCmK,EAAQM,aAAa7K,K,yBAGvB,SAAYI,EAAImD,EAAWC,GACzB,IAAM+G,EAAUjP,KAAK4K,eAAe9F,GACpCmK,EAAQhH,UAAYA,EACpBgH,EAAQ/G,QAAUA,I,2EAGpB,qGACOlI,KAAKwP,UACRxP,KAAKwP,SAAU,EACfxP,KAAKyP,QAAUC,sBAAsB1P,KAAK+O,UAH9C,SAKQ/O,KAAK2P,aAAY,GALzB,OAME3P,KAAK4P,SAAWC,YAAYC,MAN9B,gD,oIASA,WAAW7N,GAAX,4FACQ8N,EAAWvH,KAAKwH,KAAK/N,EAAOjC,KAAK4P,YACnC5P,KAAK+I,YAAcgH,GAAY/P,KAAKmI,UAF1C,uBAGInI,KAAK+I,YAAc/I,KAAKmI,SAH5B,SAIUnI,KAAK2P,aAAY,GAJ3B,OAKI3P,KAAK6I,QACL,UAAA7I,KAAK8O,aAAL,cAAA9O,MANJ,8BAQIA,KAAK+I,aAAegH,EARxB,UASU/P,KAAK2P,aAAY,GAT3B,QAUI3P,KAAK4P,SAAW3N,EAChBjC,KAAKyP,QAAUC,sBAAsB1P,KAAK+O,SAX9C,iD,6EAeA,WACE/O,KAAK4P,UAAY,EACjB5P,KAAKwP,SAAU,EACfS,qBAAqBjQ,KAAKyP,SAC1BzP,KAAK4O,SAASO,SAAQ,SAAAF,GACpBA,EAAQpG,a,qFAKZ,WAAqBE,GAArB,wFACE/I,KAAK6I,QACL7I,KAAK+I,YAAcA,EAFrB,SAGQ/I,KAAK2P,aAAY,GAHzB,gD,4IAOA,WAAkBhL,GAAlB,6FACQiK,EAAW5O,KAAK4O,SACtBA,EAASsB,MAAK,SAACC,EAAGC,GAChB,OAAOA,EAAE1L,OAASyL,EAAEzL,UAEhB2L,EAAMrQ,KAAK4O,SAASlS,OACjBF,EAAI,EANf,YAMkBA,EAAI6T,GANtB,iCAOUzB,EAASpS,GAAGqS,oBAAoBlK,GAP1C,OAM2BnI,IAN3B,uBASEwD,KAAK4E,QAAQyE,SACb,UAAArJ,KAAK6O,2BAAL,cAAA7O,KAA2BA,KAAK+I,aAVlC,iD,+EAaA,WACE/I,KAAK4O,SAASlS,OAAS,EACvBsD,KAAK4O,SAAW,K,sBAGlB,SAASK,GACPA,EAAQqB,YAAYtQ,KAAK4E,QAAQ2L,qB,KCjLjC,GAAS,WAAa,IAAIxQ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,aAAa,CAACJ,EAAG,MAAM,CAAC2B,IAAI,iBAAiBvB,YAAY,WAAWR,EAAIyQ,GAAG,GAAGzQ,EAAIyQ,GAAG,MACvM,GAAkB,CAAC,WAAa,IAAIzQ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACsQ,YAAY,CAAC,SAAW,WAAW,KAAO,IAAI,IAAM,IAAI,UAAU,OAAO,CAACtQ,EAAG,SAAS,CAACsQ,YAAY,CAAC,MAAQ,QAAQ,OAAS,SAASpQ,MAAM,CAAC,GAAK,SAAS,MAAQ,MAAM,OAAS,YAAY,WAAa,IAAIN,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,OAAO,CAACR,EAAIW,GAAG,YAAYP,EAAG,MAAMJ,EAAIW,GAAG,8B,4DCI/b,SAASgQ,GAAaC,EAAMC,GACjC,OAAO,IAAItG,SAAQ,SAACC,GAClB,IAAMsG,EAAS,IAAIC,OAAO,2BAC1BD,EAAOE,YAAY,CAAEJ,OAAMC,gBAC3BC,EAAOG,UAAY,SAASC,GAC1B1G,EAAQ,iCAAI0G,EAAE/U,MAAP,IAAagV,KAAMP,EAAKO,YAkB9B,SAASC,GAAkBR,EAAMC,GACtC,OAAO,IAAItG,SAAQ,SAACC,GAClB,IAAMsG,EAAS,IAAIC,OAAO,8BAC1BD,EAAOE,YAAY,CAAEJ,OAAMC,gBAC3BC,EAAOG,UAAY,SAASC,GAC1B1G,EAAQ0G,EAAE/U,UA+BT,SAASkV,GAAMC,GACpB,OAAO,IAAI/G,SAAQ,SAACC,GAClB3K,OAAO0R,WAAW/G,EAAS8G,M,SAuBhBE,G,mGAAf,WAA4BrF,GAA5B,0GACS,IAAI5B,SAAQ,SAACC,GAClB2B,EAAOsF,OAAP,yDAAc,WAAOC,GAAP,uGACcA,EAAKb,cADnB,OACNA,EADM,OAEZrG,EAAQqG,GAFI,2CAAd,sDAGG,aAAc,OALrB,2C,yBAaO,SAAec,GAAtB,mC,gEAAO,WAA6BxP,GAA7B,+GAAqCyP,EAArC,+BAAgD,aAAcC,EAA9D,+BAAoE,GACnE7B,EAAW,IAAO6B,EACpBC,EAAS,GACT9I,EAAc,EAHb,YAIEA,EAAc7G,EAAOiG,UAJvB,iCAKGjG,EAAO+G,eAAeF,GALzB,wBAMqBwI,GAAarP,EAAO0C,QAAQ2L,iBANjD,eAMGuB,EANH,OAOHD,EAAO7U,KAAK8U,GAPT,UAQGV,GAAMrB,GART,QASHhH,GAAegH,EATZ,8BAWL7N,EAAO+G,eAAe/G,EAAOiG,UAXxB,UAYmBoJ,GAAarP,EAAO0C,QAAQ2L,iBAZ/C,eAYCuB,EAZD,OAaLD,EAAO7U,KAAK8U,GAbP,kBAcE,IAAIxH,SAAQ,SAACC,GAElB,IAAMsG,EAAS,IAAIC,OAAO,6BAC1BD,EAAOE,YAAY,CAAEc,SAAQF,WAAUC,QACvCf,EAAOG,UAAY,SAASC,GAE1BY,EAAOnV,OAAS,EAChBmV,EAAS,GACTE,GAAaC,IAAIC,gBAAgBhB,EAAE/U,MAAOyV,GAC1CpH,GAAQ,QAvBP,4C,yBA6BP,SAASwH,GAAaG,EAASP,GAC7B,GAAK/R,OAAOuS,eAgBL,GAAQvS,OAAOuS,eAAiBvF,SAASwF,YAAa,CAC3D,IAAMC,EAAYzS,OAAO0S,KAAKJ,EAAS,UACvCG,EAAUzF,SAAS2F,QACnBF,EAAUzF,SAASwF,YAAY,UAAU,EAAMT,GAAYO,GAC3DG,EAAUE,aApBe,CACzB,IAAMC,EAAO5F,SAASC,cAAc,KAIpC,GAHA2F,EAAKC,KAAOP,EACZM,EAAKE,OAAS,SACdF,EAAKG,SAAWhB,EACZiB,UAAUC,UAAUC,cAAcC,MAAM,yBAA2BH,UAAUC,UAAUG,OAAO,UAAY,EAC5GpG,SAASqG,SAAWT,EAAKC,SACpB,CACL,IAAMS,EAAM,IAAIC,WAAW,QAAS,CAClC,KAAQvT,OACR,SAAW,EACX,YAAc,IAEhB4S,EAAKY,cAAcF,IAClBtT,OAAOoS,KAAOpS,OAAOyT,WAAWC,gBAAgBd,EAAKC,QCnI5D,QACEc,MAAO,CAAC,UACR,QAFF,WAEA,uKACA,GACA,qBACA,sBACA,4BAEA,YACA,oBACA,sCARA,SASA,MATA,OAUA,uBAVA,8CAYE3R,QAAS,CACP2Q,MADJ,WAEMlR,EAASK,MAAM,kBC/B0U,MCQ3V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,sCCRR,SAAe8R,GAAtB,mC,gEAAO,WAAyB5C,GAAzB,mHAEI,IAAItG,SAAQ,SAACC,GAClB,IAAMlC,EAAQuE,SAASC,cAAc,SACrCxE,EAAMmE,IAAMwF,IAAIC,gBAAgB,IAAIwB,KAAK,CAAC7C,GAAc,CAAElK,KAAM,eAChE2B,EAAMqL,MAAO,EAEbrL,EAAMsL,iBAAiB,aAAvB,wCAAqC,2GAE7BzM,EAAU,IAAIG,MAAMuM,aAAavL,GAFJ,SAG7BnB,EAAQ+B,eAAe,GAHM,OAInCsB,EAAQ,CAAElC,QAAOnB,YAJkB,gDAPpC,mCAeH2M,QAAQC,MAAR,MAfG,wD,yBAmBA,SAASC,GAAUpD,GACxB,OAAO,IAAIrG,SAAQ,SAACC,IAElB,IAAIlD,MAAM2M,eAAgBC,KAAKjC,IAAIC,gBAAgBtB,IAAO,SAASzJ,GACjEqD,EAAQ,CAAE6B,MAAOlF,EAAQkF,MAAOlF,kBAU/B,SAAegN,GAAtB,mC,gEAAO,WAA0BC,GAA1B,2GACmBC,MAAMD,GADzB,cACCE,EADD,gBAEoBA,EAAUC,OAF9B,cAECC,EAFD,OAGC9F,EAAY7B,SAASC,cAAc,OACzC4B,EAAU+F,MAAMzN,MAAQ,QACxB0H,EAAU+F,MAAMvN,OAAS,QACzB2F,SAAS6H,KAAKnE,YAAY7B,GANrB,kBAQED,OAAOkG,cAAc,CAC1BjG,YACAf,SAAU,SACViH,UAAU,EACVC,cAAeL,KAZZ,4C,yBCvCA,SAASM,KACd,OAAOrM,KAAKsM,SAASC,SAAS,IAAIC,OAAO,EAAG,GAOvC,SAAeC,GAAtB,mC,gEAAO,WAAkC/Y,GAAlC,yGACGwK,EAAgCxK,EAAhCwK,KAAM3H,EAA0B7C,EAA1B6C,MAAOT,EAAmBpC,EAAnBoC,KAAM6J,EAAajM,EAAbiM,SADtB,KAEGzB,EAFH,cAGEpE,EAAYE,MAHd,SAkBEF,EAAYI,MAlBd,UAgCEJ,EAAYO,WAhCd,UAuCEP,EAAYM,IAvCd,UA8CEN,EAAYQ,OA9Cd,mCAKkC0Q,GAAUzU,GAL5C,uBAKSsJ,EALT,EAKSA,MAAOnB,EALhB,EAKgBA,QALhB,kBAMQ,CACLR,KAAMA,EACNQ,QAASA,EACTmB,MAAOA,EACP/J,KAAMA,EACN6J,SAA2B,IAAjBE,EAAMF,SAChB7C,OAAQnC,EAAWC,UACnB2D,MAAOsB,EAAMvB,WACbG,OAAQoB,EAAMrB,YACd/B,QAASlC,EAAQG,QAfpB,yBAoBkC6Q,GAAUhV,GApB5C,wBAoBSqN,EApBT,EAoBSA,MAAOlF,EApBhB,EAoBgBA,QApBhB,kBAqBQ,CACLR,KAAMA,EACNQ,QAASA,EACTH,MAAOqF,EAAM8I,aACbjO,OAAQmF,EAAM+I,cACd7P,OAAQnC,EAAWC,UACnB6B,QAASlC,EAAQG,MACjB5E,KAAMA,EACN6J,SAAU,MA7Bb,iCAiCM,CACLzB,KAAMA,EACNX,WAAYhH,EACZT,KAAMA,EACN6J,SAAUA,IArCX,iCAwCM,CACLzB,KAAMA,EACNyG,KAAMpB,GAAShN,GACfT,KAAMA,EACN6J,SAAUA,IA5CX,iCA+CM,CACLzB,KAAMA,EACNpI,KAAMA,EACNkQ,OAAQzP,EACRoJ,SAAUA,IAnDX,4C,yBAwDA,SAASiN,GAAmBlZ,EAAMmZ,EAAUC,GACjD,IAAMC,EAAerZ,EAAKiM,SAAW,EACrC,MAAO,CACLzB,KAAMpE,EAAYO,WAClBkD,WAAY7J,EAAK6C,MACjB+F,GAAI+P,KACJpK,OAAQ4K,EAASvQ,GACjB4F,KAAM4K,EAASxQ,GACfmD,UAAWoN,EAASnN,QAAUqN,EAC9BrN,QAASmN,EAASnN,QAAUqN,EAC5BpN,SAAUjM,EAAKiM,SACf7J,KAAMpC,EAAKoC,MAIR,SAAekX,GAAtB,uC,gEAAO,WAA+BtZ,EAAMuZ,EAAqBC,GAA1D,+GACqBT,GAAmB/Y,GADxC,cACCyZ,EADD,OAECxN,EAAWwN,EAAYxN,SACvBpB,EAAQoB,EAAW,IAAO9F,EAC1BuT,EAAY7O,GAAS0O,EAAoBI,EAAIzT,GAC7C6F,EAAYO,KAAKsN,IAAI,GAAIJ,EAAiBG,EAAID,GAAavT,EAAiB,KAL7E,kCAOHyC,GAAI+P,KACJ5M,UAAWA,EACXC,QAASD,EAAYE,GAClBwN,IAVA,2C,yBAcA,SAASI,GAAQF,GACtB,OAAOA,EAAIxT,EAAiB,IAGvB,SAAS2T,GAAepH,EAAUiH,GACvC,IAAM5T,EAAO8T,GAAQF,GACrB,GAAI5T,GAAQ2M,EAAS,GAAG3G,UACtB,OAAO,EAET,IAAK,IAAIzL,EAAI,EAAGA,EAAIoS,EAASlS,OAAS,EAAGF,IACvC,GAAIyF,EAAO2M,EAASpS,GAAG0L,SAAWjG,EAAO2M,EAASpS,EAAI,GAAGyL,UACvD,OAAOzL,EAAI,EAGf,OAAIyF,GAAQ2M,EAASA,EAASlS,OAAS,GAAGwL,QACjC0G,EAASlS,YADlB,EAKK,SAASuZ,GAAYZ,EAAUC,GACpC,IAAmBY,EAAoBb,EAA/BpN,UAAwBkO,EAAOd,EAAhBnN,QACJkO,EAAoBd,EAA/BrN,UAAwBoO,EAAOf,EAAhBpN,QACvB,OAAIgO,EAAKE,EACCD,EAAKC,EAAOD,EAAKD,EAAKG,EAAKD,EAE3BC,EAAKH,EAAOC,EAAKD,EAAKG,EAAKD,EAKhC,SAASE,GAAiB1H,GAE/B,IADA,IAAMyB,EAAMzB,EAASlS,OACZF,EAAI,EAAGA,EAAI6T,EAAM,EAAG7T,IAAK,CAChC,IAAM2Z,EAAKvH,EAASpS,GACd6Z,EAAKzH,EAASpS,EAAI,GACpByZ,GAAYE,EAAIE,KAClBA,EAAGpO,UAAYkO,EAAGjO,QAClBmO,EAAGnO,QAAUmO,EAAGpO,UAAYoO,EAAGlO,WAK9B,SAASoO,GAAiC3H,GAC/C,OAAOA,EAAS4H,QAAO,SAACvH,GACtB,OAAOA,EAAQvS,OAAS,KACvB+Z,OAGE,SAASC,GAAY9H,GAC1B,IAAM+H,EAAiBJ,GAAiC3H,GACpDzG,EAAW,EAMf,OALAwO,EAAexH,SAAQ,YAAiB,IAAdjH,EAAc,EAAdA,QACpBA,EAAUC,IACZA,EAAWD,MAGRC,EAGF,SAASyO,GAASvF,GACvB,IAAMwF,EAAUrO,KAAKsO,MAAMzF,GACrB0F,EAASF,EAAU,IACnB/Y,EAAI0K,KAAKwO,MAAMH,EAAU,KACzBI,EAAQnZ,EAAI,GACZK,EAAIqK,KAAKwO,MAAMlZ,EAAI,IACnBoZ,EAAQ/Y,EAAI,GACZgZ,EAAI3O,KAAKwO,MAAM7Y,EAAI,IACzB,gBAAUgZ,EAAEpC,WAAWqC,SAAS,EAAG,KAAnC,YAA2CF,EAAMnC,WAAWqC,SAAS,EAAG,KAAxE,YAAgFH,EAAMlC,WAAWqC,SAAS,EAAG,KAA7G,YAAqHL,EAAOhC,WAAWqC,SAAS,EAAG,MC/IrJ,QACEC,WAAY,CAAd,iBACEnb,KAFF,WAGI,MAAO,CACLgG,OAAQ,KACRF,WAAW,EACXsV,WAAW,EACXvO,YAAa,IAGjBwO,SAAU,CACRtV,KADJ,WAEM,OAAO2U,GAAS5W,KAAK+I,eAGzBtH,QAfF,WAeA,WACA,GACMsF,MAAO,IACPE,OAAQ,IACR2H,SAAU,GACVC,oBAAqB,SAA3B,GACQ,EAAR,cACQxN,EAASK,MAAM,2BAA4BqH,IAE7C+F,MAAO,WACL,EAAR,eAGI9O,KAAKkC,OAAS,IAAI,GAAtB,GACIlC,KAAKkC,OAAO+G,eAAe,GAC3BjJ,KAAKkC,OAAOsV,SAASxX,KAAKyX,MAAM,mBAEhCpW,EAASM,IAAI,cAAc,SAA/B,KACM,EAAN,OACM,EAAN,UACM,EAAN,0BAEIN,EAASM,IAAI,iBAAiB,SAAlC,GACM,EAAN,UACM,EAAN,0BAEIN,EAASM,IAAI,0BAA0B,SAA3C,GACM,EAAN,cACM,EAAN,4BAEIN,EAASM,IAAI,eAAe,WAC1B,EAAN,gBAEIN,EAASM,IAAI,eAAe,WAC1B,EAAN,iBAGEC,QAAS,CACPiD,IADJ,SACA,GACM7E,KAAKkC,OAAOwV,WAAWzI,IAEzBlK,OAJJ,SAIA,GACM/E,KAAKkC,OAAOyV,cAAc7S,IAE5B8S,OAPJ,SAOA,cACMhJ,EAAS4H,QAAO,SAAtB,GACQ,OAAOvH,EAAQvS,OAAS,KAChC,uBACQkS,EAASO,SAAQ,SAAzB,wCACU,EAAV,yBACU,EAAV,iCAIIpN,gBAjBJ,WAkBW/B,KAAKgC,WAIRhC,KAAKgC,WAAY,EACjBhC,KAAKkC,OAAO2G,UAJZ7I,KAAKgC,WAAY,EACjBhC,KAAKkC,OAAO0G,WC9F2U,MCQ3V,I,UAAY,eACd,GACA,EACA,GACA,EACA,KACA,WACA,OAIa,M,QCnBX,GAAS,WAAa,IAAI7I,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,aAAa,CAACJ,EAAG,MAAM,CAACI,YAAY,mBAAmB,CAACJ,EAAG,MAAM,CAACI,YAAY,cAAciU,MAAM,CAAGzN,MAAOhH,EAAI8X,YAAc,MAAQrX,GAAG,CAAC,SAAS,SAASO,GAAQ,OAAOhB,EAAI+X,cAAc/W,MAAW,CAACZ,EAAG,SAAS,CAACE,MAAM,CAAC,YAAcN,EAAIgJ,eAAe5I,EAAG,MAAM,CAACI,YAAY,aAAaR,EAAIY,GAAIoX,MAAMhY,EAAIoI,WAAW,SAASvH,EAAKoX,GAAO,OAAO7X,EAAG,MAAM,CAACd,IAAI2Y,EAAMzX,YAAY,cAAc,CAACR,EAAIW,GAAGX,EAAImB,GAAG8W,SAAY,GAAG7X,EAAG,MAAM,CAACI,YAAY,kBAAkBR,EAAIY,GAAIZ,EAAQ,MAAE,SAASa,EAAKoX,GAAO,OAAO7X,EAAG,MAAM,CAACd,IAAIuB,EAAOA,EAAKkE,GAAKkT,EAAMnX,MAAMd,EAAIkY,WAAWD,GAAOxX,GAAG,CAAC,UAAYT,EAAImY,oBAAoB,CAACnY,EAAIY,GAAG,GAAO,SAASwX,EAAQC,GAAQ,MAAO,CAACjY,EAAG,MAAM,CAACd,IAAI8Y,EAAQrT,GAAGjE,MAAMd,EAAIsY,kBAAkBF,GAAS3D,MAAOzU,EAAIuY,gBAAgBH,GAAU3X,GAAG,CAAC,MAAQ,SAASO,GAAQ,OAAOhB,EAAIwY,aAAaJ,EAAQrT,OAAO,CAAC/E,EAAIW,GAAG,IAAIX,EAAImB,GAAGiX,EAAQ7Z,MAAM,OAAQyB,EAAIyY,WAAW5X,EAAMwX,GAASjY,EAAG,MAAM,CAACd,IAAI,cAAgB8Y,EAAQrT,GAAGjE,MAAMd,EAAI0Y,qBAAqB,cAAgBN,EAAQrT,IAAI0P,MAAOzU,EAAI2Y,mBAAmBP,GAAU9X,MAAM,CAAC,UAAU,cAAgB8X,EAAQrT,MAAM/E,EAAIoC,UAAS,MAAK,IAAI,QACtsC,GAAkB,GCDlB,I,oBAAS,WAAa,IAAIpC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,SAASiU,MAAM,CAAGmE,KAAM5Y,EAAI4Y,OAAS,CAACxY,EAAG,MAAM,CAACE,MAAM,CAAC,MAAQ,KAAK,OAAS,KAAK,QAAU,YAAY,KAAO,OAAO,MAAQ,+BAA+B,CAACF,EAAG,OAAO,CAACE,MAAM,CAAC,EAAI,sQAAsQ,KAAO,iBACnjB,GAAkB,GCOtB,IACEkT,MAAO,CAAC,eACRgE,SAAU,CACRoB,KADJ,WAEM,MAAO,GAAb,0CCZ+V,MCQ3V,I,UAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCkCf,IACEtB,WAAY,CAAd,WACEnb,KAFF,WAGI,MAAO,CACL0c,KAAM,CAAC,IACPC,WAAY,EACZC,OAAQjV,EAAYC,QAEpBiV,aAAc,GAGdC,QAAS,EACTC,QAAS,EAETlQ,YAAa,EAEbmQ,SAAU,OAGd3B,SAAU,CACRpP,SADJ,WAEM,OAAO,IAET0P,YAJJ,WAKM,OAAO7X,KAAKmI,SAAW9F,EAAiB,KAG5CT,QAAS,CACPqW,WADJ,SACA,GACM,IAAN,2CACA,gBAUM,OATIa,IAAWjV,EAAYE,UAAa6U,EAAKO,GAAWzc,OAE9D,kBACYmc,IAAcM,EAChB5b,EAAOP,KAAK,SACtB,aACUO,EAAOP,KAAK,YALdO,EAAOP,KAAK,WAQPO,GAETkb,qBAfJ,SAeA,GACM,IAAN,cACA,2BAOM,OANIK,IAAWjV,EAAYK,oBACzB3G,EAAOP,KAAK,WACpB,4BACA,uBACQO,EAAOP,KAAK,SAEPO,GAETmb,mBA1BJ,SA0BA,GACM,MAAO,CAAb,4BAEIU,qBA7BJ,SA6BA,GACM,IAAN,sDACM,OAAOC,EAAUhK,QAAQJ,IAE3B,IAjCJ,SAiCA,sLACA,+CADA,SAEA,kBAFA,OAEA,EAFA,OAGA,OACA,UAGA,UACA,gBACA,OAJA,wBAMA,gBACA,0BAZA,8CAcIqK,cA/CJ,SA+CA,GAIM,IAHA,IAEN,IAFA,gCACA,8BAEA,mBAEQ,IADA,IAAR,OACA,mBACU,GAAIC,EAAM7b,GAAGoH,KAAO0U,EAAY,CAC9BnE,EAAWkE,EAAM7b,GACjB4X,EAAWiE,EAAM7b,EAAI,GACrB,IAAZ,YAIY,OAHA6b,EAAM3b,OAAOF,EAAI,EAAG,EAAGqI,GACvB1E,EAASK,MAAM,aAAckX,EAAM7S,QACnC/F,KAAKkZ,SAAWnT,EAAWjB,MAMnCC,OAlEJ,WAoEM,IADA,IAAN,YACA,mBAEQ,IADA,IAAR,OACA,oBACU,IACV,IADA,OACU,GAAIkK,EAAQnK,KAAO9E,KAAKkZ,UAClC,4DACctK,EAAShR,OAAOF,EAAG,IACjC,4DACckR,EAAShR,OAAOF,EAAI,EAAG,GAEvBkR,EAAShR,OAAOF,EAAG,GAEhBkR,EAASlS,QAA0B,IAAhBkc,EAAKlc,QAC3Bkc,EAAKhb,OAAOpB,EAAG,KAMzB0b,kBAvFJ,SAuFA,GACM,IAAN,wBACMlY,KAAKgZ,QAAUA,EACfhZ,KAAKiZ,QAAUA,GAEjBZ,kBA5FJ,SA4FA,GACM,IAAN,gBACA,cAOM,OANIa,IAAajK,EAAQnK,IACvBvH,EAAOP,KAAK,UAEViS,EAAQvI,OAASpE,EAAYO,YAC/BtF,EAAOP,KAAK,cAEPO,GAET+a,gBAvGJ,SAuGA,GACM,IAAN,0BACM,MAAO,CACLK,KAAM,GAAd,qBACQ5R,MAAO,GAAf,2BAGI+Q,cA9GJ,SA8GA,GACM,IAAN,0CACA,mBACA,eACA,gBACM9X,KAAK+I,YAAcP,KAAKiR,IAAIjR,KAAKsN,IAAI,EAAG/M,GAAcZ,GACtD9G,EAASK,MAAM,yBAA0B1B,KAAK+I,cAEhDwP,aAtHJ,SAsHA,GACMvY,KAAKkZ,SAAWpU,GAElB0T,WAzHJ,SAyHA,KACM,IAAN,OACA,SACM,SACN,GACA,GACA,oCACA,oCAEYhQ,KAAKC,IAAI4M,EAASnN,QAAUoN,EAASrN,YAAc,QAO7DxG,QApKF,WAoKA,WACIJ,EAASM,IAAI,YAAY,WACvB,EAAN,kBACM,EAAN,gBAEIN,EAASM,IAAI,YAAY,SAA7B,GACM,EAAN,mBACM,EAAN,uCAEIN,EAASM,IAAI,iBAAiB,WAC5B,EAAN,iBACM,EAAN,gBAEIN,EAASM,IAAI,WAAW,SAA5B,6BACM/B,OAAO0R,YAAW,WAChB,EAAR,SACQ,EAAR,iBACQ,EAAR,eACA,QAIIjQ,EAASM,IAAI,sBAAsB,WACjC,EAAN,gCAEIN,EAASM,IAAI,sBAAsB,SAAvC,GACM,EAAN,8BACM,EAAN,0CAEIN,EAASM,IAAI,2BAA2B,WACtC,EAAN,oBAEIN,EAASM,IAAI,qBAAqB,SAAtC,2BACM/B,OAAO0R,YAAW,WAChB,EAAR,iBACQ,EAAR,mBACA,QAGIjQ,EAASM,IAAI,4BAA4B,SAA7C,GACM,EAAN,iBAEIiL,SAAS+G,iBAAiB,SAAS,SAAvC,GACoB,cAAV1C,EAAE5R,KAAuB,EAAnC,WACQgC,EAASK,MAAM,gBAAiB,EAAxC,UACQ,EAAR,eCtQiW,MCS7V,I,oBAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCpBX,GAAS,WAAa,IAAI3B,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACI,YAAY,aAAa,CAAqB,QAAnBR,EAAIe,WAAsB,CAACX,EAAG,cAAc,CAACE,MAAM,CAAC,OAAS,6CAA6CG,GAAG,CAAC,aAAaT,EAAI2Z,YAAY,CAAE3Z,EAAe,YAAEI,EAAG,MAAM,CAACI,YAAY,iBAAiB,CAACR,EAAIW,GAAG,kBAAkBX,EAAIoC,QAAQpC,EAAIY,GAAIZ,EAAI4Z,OAAO5Z,EAAIe,aAAa,SAASF,GAAM,OAAOT,EAAG,MAAM,CAACd,IAAIuB,EAAKtC,KAAKiC,YAAY,QAAQ,CAACJ,EAAG,MAAM,CAACI,YAAY,SAAS,CAACJ,EAAG,MAAM,CAACI,YAAY,UAAUC,GAAG,CAAC,UAAY,SAASO,GAAQ,OAAOhB,EAAI6Z,UAAU7Y,EAAQH,IAAO,QAAU,SAASG,GAAQ,OAAOhB,EAAI8Z,QAAQ9Y,EAAQH,MAAS,CAACb,EAAIW,GAAG,IAAIX,EAAImB,GAAGN,EAAKtC,MAAM,SAAS6B,EAAG,MAAM,CAACI,YAAY,SAAS,CAACR,EAAIW,GAAGX,EAAImB,GAAGN,EAAKtC,eAAc,IAC/vB,GAAkB,G,wBC+BtB,IACE+Y,WAAY,CAAd,iBACEnb,KAFF,WAGI,MAAO,CAEL+S,QAAS,KACT6K,OAAQ,EACRC,OAAQ,EACRC,cAAe,KAEfC,aAAa,EAGbN,OAAQ,CACNO,MAAO,GACP9P,YAAa,CACrB,CAAU,KAAV,QAAU,MAAV,QAAU,KAAV,aAAU,SAAV,KACA,CAAU,KAAV,SAAU,MAAV,SAAU,KAAV,aAAU,SAAV,KACA,CAAU,KAAV,OAAU,MAAV,OAAU,KAAV,aAAU,SAAV,MAEQ2B,SAAU,CAClB,CAAU,KAAV,WAAU,MAAV,WAAU,KAAV,MAAU,SAAV,MAEQyC,OAAQ,CAChB,CAAU,KAAV,SAAU,MAAV,wBAAU,KAAV,UACA,CAAU,KAAV,OAAU,MAAV,sBAAU,KAAV,UACA,CAAU,KAAV,aAAU,MAAV,6BAAU,KAAV,YAGM1N,WAAY,QAGhBW,QAhCF,WAgCA,WACIJ,EAASM,IAAI,aAAa,SAA9B,GACM,EAAN,iBAGEC,QAAS,CACP,UADJ,SACA,2KACA,EADA,oBAEA,6CAEA,YAJA,iCAKA,qBALA,cAKA,EALA,gBAMA,QANA,UAMA,EANA,OAOA,qFAPA,wBAQA,iBARA,UASA,QATA,QASA,EATA,OAUA,iBAVA,gCAaA,SAbA,QAeA,qBACA,YACA,QACA,SAEA,qBACA,mCArBA,+CAwBIgY,UAzBJ,SAyBA,KACM,IAAN,uDACM5Z,KAAKiP,QAAUyD,EACf1S,KAAK8Z,OAASK,EAAUna,KAAKiP,QAAQmL,wBAAwBzB,KAC7D3Y,KAAK+Z,OAASM,EAAUra,KAAKiP,QAAQmL,wBAAwBE,IAC7Dta,KAAKiP,QAAQuF,MAAMhL,SAAW,WAC9BxJ,KAAKiP,QAAQuF,MAAM9P,OAAS,IAC5B1E,KAAKua,OAAOC,EAAOC,GACnBza,KAAKga,cAAgB/K,EACrBrC,SAAS+G,iBAAiB,YAAa3T,KAAK0a,YAE9CH,OApCJ,SAoCA,KACM,IAAN,2CACMtL,EAAQuF,MAAMmE,KAAO6B,EAAQV,EAAS,KACtC7K,EAAQuF,MAAM8F,IAAMG,EAAQV,EAAS,MAEvCW,UAzCJ,SAyCA,GACM,IAAN,4CACM1a,KAAKua,OAAOC,EAAOC,GACnBza,KAAKiP,QAAQ0L,QAAS,EACtB,IAAN,iCACM3a,KAAKiP,QAAQ0L,QAAS,EAClBC,IACE5a,KAAKga,cAActT,OAASpE,EAAYO,WACtC+X,EAAUC,QAAQ,yBACpBxZ,EAASK,MAAM,qBAAsBkZ,GAErCvZ,EAASK,MAAM,qBAAsBkZ,GAGnCA,EAAUC,QAAQ,cACpBxZ,EAASK,MAAM,WAAYkZ,GAE3BvZ,EAASK,MAAM,WAAYkZ,KAKnC,QA/DJ,SA+DA,oLACA,0BACA,gDACA,oBACA,iCACA,oBACA,oCANA,gBAOA,sCACA,6BACA,OACA,qBAGA,mCAbA,2BAgBA,4BAhBA,oBAiBA,gCAjBA,kCAkBA,YAlBA,QAkBA,EAlBA,OAmBA,UACA,yCApBA,QAsBA,mBACA,OACA,qBAxBA,wBA2BA,yBA3BA,QA8BA,oBACA,4CA/BA,iDCpI+V,MCS3V,I,oBAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCQf,IACEvD,WAAY,CACVyD,SAAJ,EAAI,OAAJ,GAAI,SAAJ,GAAI,OAAJ,IAEElZ,QAAS,CACPnB,YADJ,WAEMY,EAASK,MAAM,kBClCyU,MCS1V,I,oBAAY,eACd,GACA,EACA,GACA,EACA,KACA,WACA,OAIa,M,QCXf,IACEpD,KAAM,MACN+Y,WAAY,CACV0D,OAAJ,KCZ8T,MCQ1T,I,UAAY,eACd,GACA,EACAza,GACA,EACA,KACA,KACA,OAIa,M,QChBfgB,OAAI+C,OAAO2W,eAAgB,EAE3B,IAAI1Z,OAAI,CACN+H,OAAQ,SAAA8N,GAAC,OAAIA,EAAE8D,OACdC,OAAO,S,sFCPV,W,+GCAA,W,kCCAA,W,yDCAA,W,kCCAA,W,kCCAA,W,yDCAA,W,kCCAA,W","file":"js/app.931c5dbb.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Export.vue?vue&type=style&index=0&id=07369f96&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Player.vue?vue&type=style&index=0&id=e317af16&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('Editor')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"editor\"},[_c('side-menu'),_c('div',{staticClass:\"right\"},[_c('div',{staticClass:\"toolbar-container\"},[_c('div',{staticClass:\"toolbar\"},[_c('div',{staticClass:\"left\"}),_c('button',{staticClass:\"export-button\",on:{\"click\":_vm.exportClick}},[_vm._v(\" 导出 \")])])]),_c('div',{staticClass:\"top\"},[_c('assets'),_c('player')],1),_c('time-line')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"menu\"},[_vm._l((_vm.menu),function(item){return _c('div',{key:item.value,class:['menu-item', item.value === _vm.currentTab ? 'active' : ''],on:{\"click\":function($event){return _vm.itemClick(item.value)}}},[_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"icon\",domProps:{\"innerHTML\":_vm._s(item.icon)}}),_c('span',[_vm._v(_vm._s(item.label))])])}),_c('a',{staticClass:\"tutorial\",attrs:{\"href\":\"tutorial/tutorial.mov\"}},[_vm._v(\"教程\")])],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue';\nexport const EventBus = new Vue();","<template>\n  <div class=\"container\">\n    <div class=\"menu\">\n      <div v-for=\"item in menu\" \n        :key=\"item.value\" \n        :class=\"['menu-item', item.value === currentTab ? 'active' : '']\"\n        @click=\"itemClick(item.value)\"\n      >\n        <div class=\"left\"></div>\n        <div class=\"icon\" v-html=\"item.icon\"></div>\n        <span>{{item.label}}</span>\n      </div>\n      <a class=\"tutorial\" href=\"tutorial/tutorial.mov\">教程</a>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { EventBus } from '../../utils/event-bus'\n\nconst addIcon = `<svg width=\"16\" height=\"16\" fill=\"none\" viewBox=\"0 0 16 16\"><path d=\"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z\" fill=\"currentColor\"></path></svg>`;\nconst mediaIcon = `<svg width=\"24\" height=\"24\" viewBox=\"4 2 18 20\"><g stroke=\"currentColor\" stroke-width=\"1.6\" fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12.813 4H7.125C6.228 4 5.5 4.716 5.5 5.6v12.8c0 .884.728 1.6 1.625 1.6h9.75c.897 0 1.625-.716 1.625-1.6V9.6L12.812 4z\"></path><path d=\"M12.813 4v5.6H18.5\"></path></g></svg>`;\nconst transitionIcon = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\"><path fill-rule=\"evenodd\" d=\"M0 2.4A2.4 2.4 0 012.4 0h10.8a2.4 2.4 0 012.4 2.4v10.8a2.4 2.4 0 01-2.4 2.4H2.4A2.4 2.4 0 010 13.2V2.4zM13.2 14H8V7.701l-5 3.572V4l5 3.571V1.6h5.2a.8.8 0 01.8.8v10.8a.8.8 0 01-.8.8zM8 7.636L13.09 4v7.273L8 7.636z\" fill=\"currentColor\"></path></svg>`;\nconst overlayIcon = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\"><rect x=\"1\" y=\"1\" width=\"14\" height=\"14\" rx=\"1.6\" stroke=\"currentColor\" stroke-width=\"1.6\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></rect><path d=\"M7 15l7.818-7.772V15H7z\" fill=\"currentColor\"></path><path opacity=\"0.5\" d=\"M1 15L15 1v14H1z\" fill=\"currentColor\"></path></svg>`;\nconst MENU = [\n  { label: '添加', value: 'add', icon: addIcon },\n  { label: '媒体', value: 'media', icon: mediaIcon },\n  { label: '转场', value: 'transitions', icon: transitionIcon },\n  { label: '覆盖', value: 'overlays', icon: overlayIcon },\n  { label: 'Lottie', value: 'lottie', icon: mediaIcon },\n];\nexport default {\n  data() {\n    return {\n      menu: MENU,\n      currentTab: MENU[0].value\n    };\n  },\n  mounted() {\n    EventBus.$emit('changeTab', this.currentTab);\n    EventBus.$on('changeTab2Media', () => {\n      this.currentTab = 'media';\n    });\n  },\n  methods: {\n    itemClick(value) {\n      this.currentTab = value;\n      EventBus.$emit('changeTab', value);\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  background: rgb(39, 39, 49);\n  height: 100%;\n  width: 60px;\n  display: flex;\n  flex-direction: column;\n  -webkit-box-align: center;\n  align-items: center;\n  overflow: hidden;\n  flex-shrink: 0;\n}\n.menu {\n  padding-top: 50px;\n}\n.menu-item .left {\n  display: none;\n}\n.menu-item.active .left {\n  display: block;\n  height: 100%;\n  width: 2px;\n  background: rgb(147, 130, 215);\n  transition: all 200ms ease-in-out 0s;\n  position: absolute;\n  left: 0px;\n}\n.menu-item {\n  position: relative;\n  height: 60px;\n  width: 60px;\n  display: flex;\n  flex-direction: column;\n  -webkit-box-align: center;\n  align-items: center;\n  -webkit-box-pack: center;\n  justify-content: center;\n  border: none;\n  background: transparent;\n  font-size: 8px;\n  transition: background 100ms ease-in-out 0s;\n  cursor: pointer;\n  padding: 6px 0;\n}\n.menu-item span {\n  color: rgb(192, 192, 205);\n  font-size: 12px;\n  margin-top: 5px;\n}\n.menu .icon {\n  display: flex;\n  flex-direction: row;\n  -webkit-box-align: center;\n  align-items: center;\n  opacity: 1;\n  color: white;\n  width: 16px;\n  height: 16px;\n}\n.menu-item:hover span, .menu-item.active span {\n  color: white;\n}\n.tutorial {\n  color: white;\n  text-decoration: none;\n  font-size: 14px;\n  margin-top: 50px;\n  display: block;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SideMenu.vue?vue&type=template&id=e4cf187a&scoped=true&\"\nimport script from \"./SideMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./SideMenu.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SideMenu.vue?vue&type=style&index=0&id=e4cf187a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e4cf187a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"player\"},[_c('div',{ref:\"videoContainer\",staticClass:\"video\"}),_c('div',{staticClass:\"controls\"},[_c('div',{staticClass:\"play-button\",on:{\"click\":_vm.playButtonClick}},[(!_vm.isPlaying)?_c('svg',{attrs:{\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M20.6074 11.3193L7.37206 3.13743C7.10118 2.97052 6.75265 2.95415 6.46676 3.09652C6.17912 3.23888 6 3.51624 6 3.81815V20.1818C6 20.4837 6.17912 20.7611 6.46588 20.9035C6.59647 20.9681 6.73941 21 6.88235 21C7.05353 21 7.22471 20.9534 7.37206 20.8625L20.6074 12.6807C20.8526 12.5285 21 12.2733 21 12C21 11.7267 20.8526 11.4714 20.6074 11.3193Z\",\"fill\":\"currentColor\"}})]):_c('svg',{attrs:{\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\"}},[_c('rect',{attrs:{\"x\":\"14\",\"y\":\"4\",\"width\":\"6\",\"height\":\"16\",\"rx\":\"1\",\"fill\":\"currentColor\"}}),_c('rect',{attrs:{\"x\":\"4\",\"y\":\"4\",\"width\":\"6\",\"height\":\"16\",\"rx\":\"1\",\"fill\":\"currentColor\"}})])]),_c('div',{staticClass:\"time\"},[_vm._v(_vm._s(_vm.time))])])]),(_vm.exporting)?_c('export-dialog',{attrs:{\"player\":_vm.player}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export const CardWidth = 135;\nexport const WidthPerSecond = 40;\n\nexport const ElementType = Object.freeze({\n  VIDEO: 'Video',\n  AUDIO: 'Audio',\n  IMAGE: 'Image',\n  TEXT: 'Text',\n  SVG: 'Svg',\n  TRANSITION: 'Transition',\n  LOTTIE: 'Lottie'\n});\n\nexport const FitType = Object.freeze({\n  FILL: 0, // 铺满整个播放器，不考虑长宽比\n  CONTAIN: 1, // 保持长宽比，不会被裁剪，可能没法铺满整个播放器\n  COVER: 2 // 铺满整个播放器，同时保持长宽比，可能存在裁剪\n});\n\nexport const EffectType = Object.freeze({\n  NO_EFFECT: 0,\n  BLUR: 1,\n  GRAY: 2\n});\n\nexport const TransitionType = Object.freeze({\n  MORPH: 0,\n  DREAMY: 1,\n  FADE: 2,\n});\n\nexport const OverlayType = Object.freeze({\n  PLUNGING: 0\n});\n\nexport const DRAG_STATUS = Object.freeze({\n  UNKNOWN: -1,\n  DRAGGING: 0,\n  DRAG_OVER: 1,\n  TRANSITION_UNKNOWN: 2,\n  TRANSITION_DRAGGING: 3,\n  TRANSITION_DRAG_OVER: 4\n});","export class Element {\n  constructor(config, player) {\n    Object.assign(this, config);\n    this.player = player;\n    this.isAttachToPainter = false;\n    this.sprite = null;\n    this.isStart = false;\n  }\n\n  updateZIndex(zIndex) {\n    this.zIndex = zIndex;\n  }\n\n  onCurrentTimeChange(isManual) {\n  }\n\n  pause() {\n  }\n\n  addToPainter() {\n    if (!this.isAttachToPainter) {\n      this.isAttachToPainter = true;\n      this.player.painter.add(this.sprite, this.id);\n    }\n  }\n\n  removeFromPainter() {\n    if (this.isAttachToPainter) {\n      this.isAttachToPainter = false;\n      this.player.painter.remove(this.id);\n    }\n  }\n}","/**\n * 组装transition和effect\n */\nimport { EffectType, FitType, TransitionType } from '../constants/common.js';\n\nfunction getColorFunction(fitType, ratio) {\n  switch (fitType) {\n    case FitType.FILL:\n      return 'uv';\n    case FitType.CONTAIN:\n      return `.5+(uv-.5)*vec2(max(ratio/${ratio},1.),max(${ratio}/ratio,1.))`;\n    case FitType.COVER:\n      return `.5+(uv-.5)*vec2(min(ratio/${ratio},1.),min(${ratio}/ratio,1.))`;\n  }\n}\n\nexport class Shader {\n  static GetVertex() {\n    const vertexTemplate = `\n      varying vec2 texCoords;\n      void main() {\n        texCoords = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    `;\n    return vertexTemplate;\n  }\n\n  static GetFragment() {\n    const fragTemplate = `\n      varying vec2 texCoords;\n      uniform sampler2D tex;\n      void main() {\n        gl_FragColor = texture2D(tex, texCoords);\n      }\n    `;\n    return fragTemplate;\n  }\n\n  static GetEffectFragment({ \n    fitType = FitType.CONTAIN, \n    effect,\n    elementRatio\n  }) {\n    const colorFun = getColorFunction(fitType, elementRatio);\n    const fragTemplate = `\n      varying vec2 texCoords;\n      uniform float ratio;\n      uniform sampler2D tex;\n      ${effect}\n      vec4 getColor(vec2 uv) {\n        vec2 newUV = ${colorFun};\n        vec4 color = effect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      void main() {\n        gl_FragColor = getColor(texCoords);\n      }\n    `;\n    return fragTemplate;\n  }\n\n  static GetTransitionFragment({\n    fromFitType = FitType.CONTAIN,\n    fromEffect,\n    fromRatio,\n    toFitType = FitType.CONTAIN,\n    toEffect,\n    toRatio,\n    transition\n  }) {\n    const fromColorFun = getColorFunction(fromFitType, fromRatio);\n    const toColorFun = getColorFunction(toFitType, toRatio);\n    const fragTemplate = `\n      varying vec2 texCoords;\n      uniform sampler2D from, to;\n      uniform float fromRatio, toRatio;\n      uniform float progress, ratio;\n      ${fromEffect}\n      ${toEffect}\n      vec4 getFromColor(vec2 uv) {\n        vec2 newUV = ${fromColorFun};\n        vec4 color = fromEffect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      vec4 getToColor(vec2 uv) {\n        vec2 newUV = ${toColorFun};\n        vec4 color = toEffect(newUV);\n        if(newUV.x>1. || newUV.x<0. || newUV.y>1. || newUV.y<0.){\n          return vec4(0.,0.,0.,0.);\n        }\n        return color;\n      }\n      ${transition}\n      void main() {\n        gl_FragColor = transition(texCoords);\n      }\n    `;\n    return fragTemplate;\n  }\n}","export function noEffect() {\n  return {\n    uniforms: {},\n    fragment: (texName = 'tex', funName = 'effect') => `\n      vec4 ${funName}(vec2 uv) {\n        return texture2D(${texName}, uv);\n      }\n    `\n  };\n}","export function gray() {\n  return {\n    uniforms: {},\n    fragment: (texName = 'tex', funName = 'effect') => `\n      vec4 ${funName}(vec2 uv) {\n        vec4 color = texture2D(${texName}, uv);\n        float gray = (color.r+color.g+color.b)/3.;\n        return vec4(gray,gray,gray,color.a);\n      }\n    `\n  };\n}","import { EffectType } from '../constants/common.js';\nimport { noEffect } from './no_effect.js';\nimport { gray } from './gray.js';\n\nconst effectMap = Object.freeze({\n  [EffectType.NO_EFFECT]: noEffect,\n  [EffectType.GRAY]: gray\n});\n\nexport default function effects(type) {\n  return effectMap[type]();\n}","/**\n * 视频不能通过设置currentTime实现播放\n * 存在视频已播完，但是下一个currentTime仍在有效范围内，会再次播放的bug\n */\nimport { Element } from './element.js';\nimport { Shader } from './shader.js';\nimport effects from '../effects/index.js';\n\nexport class Video extends Element {\n  originEffect = 0;\n\n  constructor(config, player) {\n    super(config, player);\n    this.initRender();\n    this.setPlaybackRate();   \n  }\n\n  initRender() {\n    const { \n      width: videoWidth, \n      height: videoHeight,\n      effect,\n      texture,\n      fitType,\n      player: { width, height }\n    } = this;\n    const { uniforms, fragment } = effects(effect);\n    this.originEffect = effect;\n    // eslint-disable-next-line no-undef\n    this.geometry = new THREE.PlaneGeometry(width, height);\n    // eslint-disable-next-line no-undef\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        tex: { value: texture },\n        ratio: { value: width / height },\n        ...uniforms\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetEffectFragment({\n        elementRatio: videoWidth / videoHeight,\n        fitType: fitType,\n        effect: fragment()\n      }),\n      uniformsNeedUpdate: true\n    });\n    this.material.transparent = true;\n    // eslint-disable-next-line no-undef\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n  }\n\n  getPlaybackRate() {\n    // duration 原始视频时长\n    const { startTime, endTime, duration } = this;\n    const customDuration = endTime - startTime;\n    return duration / customDuration;\n  }\n\n  setPlaybackRate() {\n    const video = this.video;\n    const newPlaybackRate = this.getPlaybackRate();\n    if (Math.abs(video.playbackRate - newPlaybackRate) >= 10e-6) {\n      video.playbackRate = newPlaybackRate;\n    }\n  }\n\n  play() {\n    const video = this.video;\n    if (video.paused) {\n      video.play();\n    }\n  }\n\n  pause() {\n    super.pause();\n    const video = this.video;\n    if (!video.paused) {\n      video.pause();\n    }\n  }\n\n  show() {\n    this.sprite.visible = true;\n  }\n\n  hide() {\n    this.sprite.visible = false;\n  }\n\n  // 根据player的currentTime校正video的currentTime\n  async correctVideoCurrentTime() {\n    const { startTime, texture, player: { currentTime } } = this;\n    const playbackRate = this.getPlaybackRate();\n    const newCurrentTime = (currentTime - startTime) * playbackRate / 1000;\n    await texture.setCurrentTime(newCurrentTime);\n  }\n\n  async onCurrentTimeChange(isManual) {\n    if (this.player.isInRange(this)) { // 在有效的播放范围内\n      if (isManual) {\n        this.pause();\n        await this.correctVideoCurrentTime();\n      } else {\n        this.play();\n      }\n      this.isStart = true;\n      this.addToPainter();\n      this.render();\n    } else {\n      if (this.isStart) { // 上一帧在播放\n        this.isStart = false;\n        this.pause();\n        this.removeFromPainter();\n      }\n    }\n  }\n\n  updateShader() {\n    if (this.originEffect !== this.effect) { // 需要更新着色器\n      // console.log( 'update material');\n\n      // // generate shaders on-demand!\n      // let fs = new ShadersFragment(this._uniforms);\n      // let vs = new ShadersVertex();\n  \n      // this._material.vertexShader = vs.compute();\n      // this._material.fragmentShader = fs.compute();\n      // this._material.needsUpdate = true;\n    }\n  }\n\n  render() {\n    this.updateShader();\n    this.sprite.position.z = this.zIndex;\n  }\n}","import { Element } from './element.js';\nimport { Shader } from './shader.js';\nimport effects from '../effects/index.js';\n\nexport class Image extends Element {\n  originEffect = 0;\n\n  constructor(config, player) {\n    super(config, player);\n    this.initRender();\n  }\n\n  initRender() {\n    const { \n      width: imageWidth, \n      height: imageHeight,\n      effect,\n      texture,\n      fitType,\n      player: { width, height }\n    } = this;\n    const { uniforms, fragment } = effects(effect);\n    this.originEffect = effect;\n    // eslint-disable-next-line no-undef\n    this.geometry = new THREE.PlaneGeometry(width, height);\n    // eslint-disable-next-line no-undef\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        tex: { value: texture },\n        ratio: { value: width / height },\n        ...uniforms\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetEffectFragment({\n        elementRatio: imageWidth / imageHeight,\n        fitType: fitType,\n        effect: fragment()\n      }),\n      uniformsNeedUpdate: true\n    });\n    this.material.transparent = true;\n    // eslint-disable-next-line no-undef\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n  }\n\n  show() {\n    this.sprite.visible = true;\n  }\n\n  hide() {\n    this.sprite.visible = false;\n  }\n\n  onCurrentTimeChange() {\n    if (this.player.isInRange(this)) { // 在有效的播放范围内\n      this.addToPainter();\n      this.render();\n    } else {\n      this.removeFromPainter();\n    }\n  }\n\n  updateShader() {\n    if (this.originEffect !== this.effect) { // 需要更新着色器\n    }\n  }\n\n  render() {\n    this.updateShader();\n    this.sprite.position.z = this.zIndex;\n  }\n}","import { Element } from './element.js';\n\nexport class Text extends Element {\n  constructor(config, player) {\n    super(config, player);\n  }\n}","import { Element } from './element.js';\n\nexport class Audio extends Element {\n  constructor(config, player) {\n    super(config, player);\n  }\n}","export function morph() {\n  return {\n    uniforms: {\n      strength: { value: 0.1 }\n    },\n    fragment: `\n      uniform float strength; // = 0.1\n      vec4 transition(vec2 p) {\n        vec4 ca = getFromColor(p);\n        vec4 cb = getToColor(p);\n        \n        vec2 oa = (((ca.rg+ca.b)*0.5)*2.0-1.0);\n        vec2 ob = (((cb.rg+cb.b)*0.5)*2.0-1.0);\n        vec2 oc = mix(oa,ob,0.5)*strength;\n        \n        float w0 = progress;\n        float w1 = 1.0-w0;\n        return mix(getFromColor(p+oc*w0), getToColor(p-oc*w1), progress);\n      }\n    `\n  };\n}","export function dreamy() {\n  return {\n    uniforms: {},\n    fragment: `\n      vec2 offset(float progress, float x, float theta) {\n        float phase = progress*progress + progress + theta;\n        float shifty = 0.03*progress*cos(10.0*(progress+x));\n        return vec2(0, shifty);\n      }\n      vec4 transition(vec2 p) {\n        return mix(getFromColor(p + offset(progress, p.x, 0.0)), getToColor(p + offset(1.0-progress, p.x, 3.14)), progress);\n      }\n    `\n  };\n}","export function fade() {\n  return {\n    uniforms: {},\n    fragment: `\n      vec4 transition(vec2 uv) {\n        return mix(\n          getFromColor(uv),\n          getToColor(uv),\n          progress\n        );\n      }\n    `\n  };\n}","import { TransitionType } from '../constants/common.js';\nimport { morph } from './morph.js';\nimport { dreamy } from './dreamy.js';\nimport { fade } from './fade.js';\n\nconst transitionMap = Object.freeze({\n  [TransitionType.MORPH]: morph,\n  [TransitionType.DREAMY]: dreamy,\n  [TransitionType.FADE]: fade\n});\n\nexport default function transitions(type) {\n  return transitionMap[type]();\n}","/**\n * 连结两个视频或者图片\n * 两个视频都设置needRender为false，如果player的currentTime在第一个视频，则调用第一个视频的setCurrentTime，否则调用第二个的，如果是图片则不需要调用\n */\nimport { Element } from './element.js';\nimport { Shader } from './shader.js';\nimport effects from '../effects/index.js';\nimport transitions from '../transitions/index.js';\n\nexport class Transition extends Element {\n  constructor(config, player) {\n    super(config, player);\n    Promise.resolve().then(() => {\n      const { player, fromId, toId } = this;\n      this.from = player.getElementById(fromId);\n      this.to = player.getElementById(toId);\n      this.initRender();\n    });\n  }\n\n  // 由于不知道关联视频或者图片的初始状态，所以需要等到渲染的时候再初始化\n  initRender() {\n    const { fromId, toId, transition, player } = this;\n    const { width, height } = player;\n    const {\n      width: fromWidth, \n      height: fromHeight,\n      effect: fromEffect,\n      texture: fromTexture,\n      fitType: fromFitType\n    } = player.getElementById(fromId);\n    const {\n      width: toWidth, \n      height: toHeight,\n      effect: toEffect,\n      texture: toTexture,\n      fitType: toFitType\n    } = player.getElementById(toId);\n    const { uniforms: fromUniforms, fragment: fromFragment } = effects(fromEffect);\n    const { uniforms: toUniforms, fragment: toFragment } = effects(toEffect);\n    const { uniforms: transitionUniforms, fragment: transitionFragment } = transitions(transition);\n    // eslint-disable-next-line no-undef\n    this.geometry = new THREE.PlaneGeometry(width, height);\n    // eslint-disable-next-line no-undef\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        from: { value: fromTexture },\n        to: { value: toTexture },\n        progress: { value: 0 },\n        ratio: { value: width / height },\n        ...fromUniforms,\n        ...toUniforms,\n        ...transitionUniforms\n      },\n      vertexShader: Shader.GetVertex(),\n      fragmentShader: Shader.GetTransitionFragment({\n        fromFitType,\n        fromEffect: fromFragment('from', 'fromEffect'),\n        fromRatio: fromWidth / fromHeight,\n        toFitType,\n        toEffect: toFragment('to', 'toEffect'),\n        toRatio: toWidth / toHeight,\n        transition: transitionFragment\n      }),\n      uniformsNeedUpdate: true\n    });\n    this.material.transparent = true;\n    // eslint-disable-next-line no-undef\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n  }\n\n  onCurrentTimeChange() {\n    if (this.player.isInRange(this)) { // 在有效的播放范围内\n      this.addToPainter();\n      // this.from.hide();\n      // this.to.hide();\n      this.render();\n    } else {\n      this.removeFromPainter();\n      // this.from.show();\n      // this.to.show();\n    }\n  }\n\n  render() {\n    const { startTime, endTime, player: { currentTime }, from } = this;\n    const progress = (currentTime - startTime) / (endTime - startTime);\n    this.sprite.position.z = from.zIndex + 1;\n    this.material.uniforms.progress.value = progress;\n  }\n }","export function plunging({\n  startTime,\n  endTime,\n  currentTime,\n  easeType,\n  width,\n  height\n}) {\n  const progress = (currentTime - startTime) / (endTime - startTime) * 100;\n  return `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\">\n      <foreignObject width=\"100%\" height=\"100%\">\n        <div xmlns=\"http://www.w3.org/1999/xhtml\">\n          <div style=\"display: flex; align-items: stretch; width: ${width}px; height: ${height}px; clip-path: inset(${progress}% 0 0 0)\">\n            <div style=\"flex-basis: 33.33333333333333%; background: rgba(255, 255, 255, 1); clip-path: inset(0 0 0% 0)\">\n              <div style=\"width: 100%; height: 100%; background: rgba(102, 93, 195, 1)\"></div>\n            </div>\n            <div style=\"flex-basis: 33.33333333333333%; background: rgba(255, 255, 255, 1); clip-path: inset(0 0 0% 0)\">\n              <div style=\"width: 100%; height: 100%; background: rgba(102, 93, 195, 1)\"></div>\n            </div>\n            <div style=\"flex-basis: 33.33333333333333%; background: rgba(255, 255, 255, 1); clip-path: inset(0 0 0% 0)\">\n              <div style=\"width: 100%; height: 100%; background: rgba(102, 93, 195, 1)\"></div>\n            </div>\n          </div>\n        </div>\n      </foreignObject>\n    </svg>\n  `;\n}","import { OverlayType } from '../constants/common.js';\nimport { plunging } from './plunging.js';\n\nconst overlayMap = Object.freeze({\n  [OverlayType.PLUNGING]: plunging,\n});\n\nexport default function overlays(type) {\n  return overlayMap[type];\n}\n\nexport function svgToCanvas(svg, canvas, canvasContext) {\n  return new Promise((resolve) => {\n    const { width, height } = canvas;\n    const image = new Image();\n    image.width = width;\n    image.height = height;\n    image.onload = function() {\n      canvasContext.clearRect(0, 0, width, height);\n      canvasContext.drawImage(image, 0, 0);\n      resolve();\n    };\n    image.src = `data:image/svg+xml,${svg.trim()}`;\n  });\n}","import { svgToCanvas } from \"../svgs/index.js\";\nimport { Element } from \"./element.js\";\n\nexport class Svg extends Element {\n  constructor(config, player) {\n    super(config, player);\n    this.initCanvas();\n    this.initRender();\n  }\n\n  initCanvas() {\n    const { player: { width, height } } = this;\n    this.canvas = document.createElement('canvas');\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.context = this.canvas.getContext('2d');\n  }\n\n  initRender() {\n    const { player: { width, height } } = this;\n    // eslint-disable-next-line no-undef\n    this.geometry = new THREE.PlaneGeometry(width, height);\n    // eslint-disable-next-line no-undef\n    this.material = new THREE.MeshBasicMaterial();\n    // eslint-disable-next-line no-undef\n    this.material.map = new THREE.CanvasTexture(this.canvas);\n    this.material.transparent = true;\n    // eslint-disable-next-line no-undef\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n  }\n\n  async onCurrentTimeChange() {\n    if (this.player.isInRange(this)) { // 在有效的播放范围内\n      this.addToPainter();\n      await this.render();\n    } else {\n      this.removeFromPainter();\n    }\n  }\n\n  async render() {\n    const { player: { width, height, currentTime }, func, startTime, endTime } = this;\n    const svg = func({ startTime, endTime, currentTime, width, height });\n    await svgToCanvas(svg, this.canvas, this.context);\n    this.material.map.needsUpdate = true;\n    this.sprite.position.z = this.zIndex;\n  }\n}","export default class Painter {\n  constructor(width, height) {\n    // eslint-disable-next-line no-undef\n    this.scene = new THREE.Scene();\n    // eslint-disable-next-line no-undef\n    this.camera = new THREE.OrthographicCamera(width / - 2, width / 2, height / 2, height / - 2, -1000, 1000);\n    // eslint-disable-next-line no-undef\n    this.renderer = new THREE.WebGLRenderer({ \n      preserveDrawingBuffer: true,\n      antialias: true\n    });\n    // this.renderer.setPixelRatio(window.devicePixelRatio || 1);\n    this.renderer.setPixelRatio(2);\n    this.renderer.setSize(width, height);\n    this.maxAnisotropy = this.renderer.capabilities.getMaxAnisotropy();\n  }\n\n  add(sprite, name) {\n    sprite.name = name;\n    this.scene.add(sprite);\n  }\n\n  remove(name) {\n    const selectedObject = this.scene.getObjectByName(name);\n    this.scene.remove(selectedObject);\n  }\n\n  getDomElement() {\n    return this.renderer.domElement;\n  }\n\n  render() {\n    const {renderer, scene, camera} = this;\n    renderer.render(scene, camera);\n  }\n}","import { Element } from \"./element.js\";\n\nexport class Lottie extends Element {\n  constructor(config, player) {\n    super(config, player);\n    this.initRender();\n  }\n\n  initRender() {\n    const { player: { width, height } } = this;\n    // eslint-disable-next-line no-undef\n    this.geometry = new THREE.PlaneGeometry(width, height);\n    // eslint-disable-next-line no-undef\n    this.material = new THREE.MeshBasicMaterial();\n    // eslint-disable-next-line no-undef\n    const texture = new THREE.CanvasTexture();\n    texture.animation = this.lottie;\n    texture.image = this.lottie.container;\n    // eslint-disable-next-line no-undef\n    this.material.map = texture;\n    this.material.transparent = true;\n    // eslint-disable-next-line no-undef\n    this.sprite = new THREE.Mesh(this.geometry, this.material);\n  }\n\n  async onCurrentTimeChange() {\n    if (this.player.isInRange(this)) { // 在有效的播放范围内\n      this.addToPainter();\n      this.render();\n    } else {\n      this.removeFromPainter();\n    }\n  }\n\n  async render() {\n    const { player: { currentTime }, startTime } = this;\n    this.lottie.goToAndStop(currentTime - startTime);\n    this.material.map.needsUpdate = true;\n    this.sprite.position.z = this.zIndex;\n  }\n}","import { ElementType } from '../constants/common.js';\nimport { Video } from './video.js';\nimport { Image } from './image.js';\nimport { Text } from './text.js';\nimport { Audio } from './audio.js';\nimport { Transition } from './transition.js';\nimport { Svg } from './svg.js';\nimport Painter from './painter.js';\nimport { Lottie } from './lottie.js';\n\nfunction createElement(config, player) {\n  switch (config.type) {\n    case ElementType.VIDEO:\n      return new Video(config, player);\n    case ElementType.IMAGE:\n      return new Image(config, player);\n    case ElementType.TRANSITION:\n      return new Transition(config, player);\n    case ElementType.TEXT:\n      return new Text(config, player);\n    case ElementType.AUDIO:\n      return new Audio(config, player);\n    case ElementType.SVG:\n      return new Svg(config, player);\n    case ElementType.LOTTIE:\n      return new Lottie(config, player);\n  }\n}\n\n/**\n * 需要知道element在上一帧是否播放，才能精准调用pause，也就是要知道element的start和end事件，并且只调用一次\n * 视频或者音频只要在有效范围内都正常播放，转场只是隐藏sprite(不渲染)\n */\n\nexport default class Player {\n  currentTime = 0;\n  duration = 0;\n  elements = [];\n  playing = false;\n  width = 0;\n  height = 0;\n\n  // 自动播放相关\n  tickTime = -1; // 用于启动自动播放\n  tickReq = 0;\n  tickFun;\n\n  onCurrentTimeChange;\n  onEnd;\n\n  constructor({ elements, width, height, onCurrentTimeChange, onEnd }) {\n    this.width = width;\n    this.height = height;\n    this.painter = new Painter(width, height);\n    this.tickFun = this.tick.bind(this);\n    this.elements = (elements || []).map((element) => {\n      return createElement(element, this);\n    });\n    this.updateDuration();\n    this.onCurrentTimeChange = onCurrentTimeChange;\n    this.onEnd = onEnd;\n  }\n\n  updateDuration() {\n    this.duration = 0;\n    this.elements.forEach(({ endTime }) => {\n      if (endTime > this.duration) {\n        this.duration = endTime;\n      }\n    });\n  }\n\n  isInRange(element) {\n    const { startTime, endTime } = element;\n    return startTime <= this.currentTime && endTime >= this.currentTime;\n  }\n\n  getElementById(id) {\n    return this.elements.find(element => element.id === id);\n  }\n\n  addElement(element) {\n    this.elements.push(createElement(element, this));\n    this.updateDuration();\n    this.pause();\n  }\n\n  removeElement(id) {\n    const element = this.getElementById(id);\n    element.removeFromPainter();\n    this.elements.splice(this.elements.indexOf(element), 1);\n    // 删除关联的转场\n    if ([ElementType.VIDEO, ElementType.IMAGE].includes(element.type)) {\n      for (let i = 0; i < this.elements.length; i++) {\n        if (\n          this.elements[i].type === ElementType.TRANSITION &&\n          [this.elements[i].fromId, this.elements[i].toId].includes(element.id)\n        ) {\n          this.elements.splice(i, 1);\n        }\n      }\n    }\n    this.updateDuration();\n    this.pause();\n  }\n\n  updateZIndex(id, zIndex) {\n    const element = this.getElementById(id);\n    element.updateZIndex(zIndex);\n  }\n\n  updateTimes(id, startTime, endTime) {\n    const element = this.getElementById(id);\n    element.startTime = startTime;\n    element.endTime = endTime;\n  }\n\n  async play() {\n    if (!this.playing) {\n      this.playing = true;\n      this.tickReq = requestAnimationFrame(this.tickFun);\n    }\n    await this.renderFrame(false);\n    this.tickTime = performance.now();\n  }\n\n  async tick(time) {\n    const interval = Math.ceil(time - this.tickTime);\n    if (this.currentTime + interval >= this.duration) {\n      this.currentTime = this.duration;\n      await this.renderFrame(false);\n      this.pause();\n      this.onEnd?.();\n    } else {\n      this.currentTime += interval;\n      await this.renderFrame(false);\n      this.tickTime = time;\n      this.tickReq = requestAnimationFrame(this.tickFun);\n    }\n  }\n\n  pause() {\n    this.tickTime = -1;\n    this.playing = false;\n    cancelAnimationFrame(this.tickReq);\n    this.elements.forEach(element => {\n      element.pause();\n    });\n  }\n\n  // 点击进度条调用此方法\n  async setCurrentTime(currentTime) {\n    this.pause();\n    this.currentTime = currentTime;\n    await this.renderFrame(true);\n  }\n\n  // 渲染对应currentTime的帧\n  async renderFrame(isManual) {\n    const elements = this.elements;\n    elements.sort((a, b) => {\n      return b.zIndex - a.zIndex;\n    });\n    const len = this.elements.length;\n    for (let i = 0; i < len; i++) {\n      await elements[i].onCurrentTimeChange(isManual);\n    }\n    this.painter.render();\n    this.onCurrentTimeChange?.(this.currentTime);\n  }\n\n  destroy() {\n    this.elements.length = 0;\n    this.elements = [];\n  }\n\n  attachTo(element) {\n    element.appendChild(this.painter.getDomElement());\n  }\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('div',{ref:\"videoContainer\",staticClass:\"player\"}),_vm._m(0),_vm._m(1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\",\"z-index\":\"99\"}},[_c('canvas',{staticStyle:{\"width\":\"640px\",\"height\":\"360px\"},attrs:{\"id\":\"canvas\",\"width\":\"640\",\"height\":\"360\"}})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tip\"},[_vm._v(\"视频导出中...\"),_c('br'),_vm._v(\"根据视频的长度，导出时间可能需要几分钟或更长\")])}]\n\nexport { render, staticRenderFns }","/**\n * 获取媒体信息\n * @param {*} file \n * @param {*} arrayBuffer \n */\nexport function getMediaInfo(file, arrayBuffer) {\n  return new Promise((resolve) => {\n    const worker = new Worker('./workers/media_info.js');\n    worker.postMessage({ file, arrayBuffer });\n    worker.onmessage = function(e) {\n      resolve({...e.data, size: file.size});\n    }\n  });\n}\n\nexport function extractAudioInMP3(file, arrayBuffer) {\n  return new Promise((resolve) => {\n    const worker = new Worker('./workers/extract_audio.js');\n    worker.postMessage({ file, arrayBuffer });\n    worker.onmessage = function(e) {\n      resolve(e.data);\n    };\n  });\n}\n\n/**\n * 提取为h264\n */\nexport function extractVideoInMP4(file, arrayBuffer) {\n  return new Promise((resolve) => {\n    const worker = new Worker('./workers/extract_video.js');\n    worker.postMessage({ file, arrayBuffer });\n    worker.onmessage = function(e) {\n      resolve(e.data);\n    };\n  });\n}\n\nexport function listCodecs() {\n  return new Promise((resolve) => {\n    const worker = new Worker('./workers/list_codecs.js');\n\n    worker.postMessage({\n      arguments: ['-version'],\n    });\n\n    worker.onmessage = function(e) {\n      resolve(e.data);\n    }\n  });\n}\n\nexport function playAudio(blob) {\n  blob.arrayBuffer().then((buffer) => {\n    const context = new AudioContext();\n    context.decodeAudioData(buffer, (audioBuffer) => {\n      const source = context.createBufferSource();\n      source.buffer = audioBuffer;\n      source.connect(context.destination);\n      source.start();\n    });\n  });\n}\n\nexport function sleep(ms) {\n  return new Promise((resolve) => {\n    window.setTimeout(resolve, ms);\n  });\n}\n\nfunction drawImageToCanvas(canvas, ctx, image) {\n  const { width, height } = canvas;\n  return new Promise((resolve) => {\n    // const img = new Image();\n    // img.onload = function() {\n      // debugger\n      // ctx.clearRect( 0, 0, width, height );\n      // ctx.scale(1, 1);\n      ctx.drawImage(image, 0, 0, width * 2, height * 2, 0, 0, width, height);\n      // ctx.scale(0.5, 0.5);\n      canvas.toBlob(async (blob) => {\n        const arrayBuffer = await blob.arrayBuffer();\n        resolve(arrayBuffer);\n      }, 'image/jpeg', 1.0);\n    // };\n    // img.src = image; //URL.createObjectURL(image);\n  });\n}\n\nasync function getImageData(canvas) {\n  return new Promise((resolve) => {\n    canvas.toBlob(async (blob) => {\n      const arrayBuffer = await blob.arrayBuffer();\n      resolve(arrayBuffer);\n    }, 'image/jpeg', 1.0);\n  });\n}\n\n/**\n * 将player导出为h264视频文件\n * @param {*} player \n */\nexport async function exportAsVideo(player, fileName = 'export.mp4', fps = 30) {\n  const interval = 1000 / fps;\n  let frames = [];\n  let currentTime = 0;\n  while (currentTime < player.duration) {\n    await player.setCurrentTime(currentTime);\n    const imageData = await getImageData(player.painter.getDomElement());\n    frames.push(imageData);\n    await sleep(interval);\n    currentTime += interval;\n  }\n  player.setCurrentTime(player.duration);\n  const imageData = await getImageData(player.painter.getDomElement());\n  frames.push(imageData);\n  return new Promise((resolve) => {\n    // 调用ffmpeg生成视频文件\n    const worker = new Worker('./workers/export_video.js');\n    worker.postMessage({ frames, fileName, fps });\n    worker.onmessage = function(e) {\n      // 清空数据\n      frames.length = 0;\n      frames = [];\n      downloadFile(URL.createObjectURL(e.data), fileName);\n      resolve(true);\n    }\n  });\n}\n\n/* Helper function */\nfunction downloadFile(fileURL, fileName) {\n  if (!window.ActiveXObject) { // for non-IE\n    const save = document.createElement('a');\n    save.href = fileURL;\n    save.target = '_blank';\n    save.download = fileName;\n    if (navigator.userAgent.toLowerCase().match(/(ipad|iphone|safari)/) && navigator.userAgent.search(\"Chrome\") < 0) {\n      document.location = save.href;\n    } else { // window event not working here\n      const evt = new MouseEvent('click', {\n        'view': window,\n        'bubbles': true,\n        'cancelable': false\n      });\n      save.dispatchEvent(evt);\n      (window.URL || window.webkitURL).revokeObjectURL(save.href);\n    }\t\n  } else if ( !! window.ActiveXObject && document.execCommand) { // for IE < 11\n    const newWindow = window.open(fileURL, '_blank');\n    newWindow.document.close();\n    newWindow.document.execCommand('SaveAs', true, fileName || fileURL);\n    newWindow.close();\n  }\n}\n","<template>\n  <div class=\"container\">\n    <!-- <div @click=\"close\" class=\"close-btn\">关闭</div> -->\n    <div class=\"player\" ref=\"videoContainer\"></div>\n    <div style=\"position: absolute; left: 0; top: 0; z-index: 99;\">\n      <canvas id=\"canvas\" width=\"640\" height=\"360\" style=\"width: 640px; height: 360px;\"/>\n    </div>\n    <div class=\"tip\">视频导出中...<br />根据视频的长度，导出时间可能需要几分钟或更长</div>\n  </div>\n</template>\n\n<script>\nimport Player from '../../classes/player.js';\nimport { EventBus } from '../../utils/event-bus.js';\nimport { exportAsVideo } from '../../utils/media';\nexport default {\n  props: ['player'],\n  async mounted() {\n    const playerConfig = {\n      width: Math.ceil(640),\n      height: Math.ceil(360),\n      elements: this.player.elements\n    };\n    const player = new Player(playerConfig);\n    player.setCurrentTime(0);\n    player.attachTo(this.$refs['videoContainer']);\n    await exportAsVideo(player);\n    EventBus.$emit('exportClose');\n  },\n  methods: {\n    close() {\n      EventBus.$emit('exportClose');\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  background: #1c1d26;\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  z-index: 10;\n}\n.player {\n  width: 640px;\n  height: 360px;\n  position: absolute;\n  left: 50%;\n  top: 40%;\n  transform: translate(-50%, -50%);\n}\n.tip {\n  color: white;\n  line-height: 24px;\n  font-size: 14px;\n  position: absolute;\n  width: 640px;\n  left: 50%;\n  top: calc(40% + 190px);\n  transform: translateX(-50%);\n  text-align: left;\n}\n.close-btn {\n  position: absolute;\n  right: 20px;\n  top: 20px;\n  font-size: 14px;\n  color: white;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Export.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Export.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Export.vue?vue&type=template&id=07369f96&scoped=true&\"\nimport script from \"./Export.vue?vue&type=script&lang=js&\"\nexport * from \"./Export.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Export.vue?vue&type=style&index=0&id=07369f96&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"07369f96\",\n  null\n  \n)\n\nexport default component.exports","export function isString(val) {\n  return Object.prototype.toString.call(val) === '[object String]';\n}\n\nexport class CustomError {\n  constructor(code, message) {\n    this.code = code;\n    this.message = message;\n  }\n}\n\nexport async function loadVideo(arrayBuffer) {\n  try {\n    return new Promise((resolve) => {\n      const video = document.createElement('video');\n      video.src = URL.createObjectURL(new Blob([arrayBuffer], { type: 'video/mp4' }));\n      video.loop = false;\n      // 可播放的时候再resolve\n      video.addEventListener('loadeddata', async () => {\n        // eslint-disable-next-line no-undef\n        const texture = new THREE.VideoTexture(video);\n        await texture.setCurrentTime(0); // 需要调用此函数才能确保在webgl渲染时视频有默认图\n        resolve({ video, texture });\n      });\n    });\n  } catch (err) {\n    console.error(err);\n  }\n}\n\nexport function loadImage(file) {\n  return new Promise((resolve) => {\n    // eslint-disable-next-line no-undef\n    new THREE.TextureLoader().load(URL.createObjectURL(file), function(texture) {\n      resolve({ image: texture.image, texture });\n    });\n  });\n}\n\nexport async function loadSvg(path) {\n  const svg = await fetch(path);\n  return svg.text();\n}\n\nexport async function loadLottie(path) {\n  const lottieRes = await fetch(path);\n  const lottieJson = await lottieRes.json();\n  const container = document.createElement('div');\n  container.style.width = '640px'; // `${lottieJson.w}px`;\n  container.style.height = '360px'; // `${lottieJson.h}px`;\n  document.body.appendChild(container);\n  // eslint-disable-next-line no-undef\n  return lottie.loadAnimation({\n    container,\n    renderer: 'canvas',\n    autoplay: false,\n    animationData: lottieJson\n  });\n}\n","import { EffectType, ElementType, FitType } from '../constants/common';\nimport { loadVideo, loadImage, loadSvg } from '../utils/tool';\nimport overlays from '../svgs/index';\nimport { WidthPerSecond, CardWidth } from '../constants/common';\n\nexport function uniqId() {\n  return Math.random().toString(36).substr(2, 9);\n}\n\nexport function sleep(ms) {\n  return new Promise(resolve => window.setTimeout(resolve, ms));\n}\n\nexport async function assetToElementData(data) {\n  const { type, value, name, duration } = data;\n  switch (type) {\n    case ElementType.VIDEO:\n      {\n        const { video, texture } = await loadVideo(value);\n        return {\n          type: type,\n          texture: texture,\n          video: video,\n          name: name,\n          duration: video.duration * 1000,\n          effect: EffectType.NO_EFFECT,\n          width: video.videoWidth,\n          height: video.videoHeight,\n          fitType: FitType.COVER\n        };\n      }\n    case ElementType.IMAGE:\n      {\n        const { image, texture } = await loadImage(value);\n        return {\n          type: type,\n          texture: texture,\n          width: image.naturalWidth,\n          height: image.naturalHeight,\n          effect: EffectType.NO_EFFECT,\n          fitType: FitType.COVER,\n          name: name,\n          duration: 2000\n        };\n      }\n    case ElementType.TRANSITION:\n      return {\n        type: type,\n        transition: value,\n        name: name,\n        duration: duration\n      };\n    case ElementType.SVG:\n      return {\n        type: type,\n        func: overlays(value),\n        name: name,\n        duration: duration\n      };\n    case ElementType.LOTTIE:\n      return {\n        type: type,\n        name: name,\n        lottie: value,\n        duration: duration,\n      };\n  }\n}\n\nexport function geneTransitionInfo(data, element1, element2) {\n  const halfDuration = data.duration / 2;\n  return {\n    type: ElementType.TRANSITION,\n    transition: data.value,\n    id: uniqId(),\n    fromId: element1.id,\n    toId: element2.id,\n    startTime: element1.endTime - halfDuration,\n    endTime: element1.endTime + halfDuration,\n    duration: data.duration,\n    name: data.name\n  };\n}\n\nexport async function geneElementInfo(data, offsetInDragElement, offsetInDropZone) {\n  const elementData = await assetToElementData(data);\n  const duration = elementData.duration;\n  const width = duration / 1000 * WidthPerSecond;\n  const leftWidth = width * (offsetInDragElement.x / CardWidth);\n  const startTime = Math.max(0, (offsetInDropZone.x - leftWidth) / WidthPerSecond * 1000);\n  return {\n    id: uniqId(),\n    startTime: startTime,\n    endTime: startTime + duration,\n    ...elementData\n  };\n}\n\nexport function xToTime(x) {\n  return x / WidthPerSecond * 1000;\n}\n\nexport function getInsertIndex(elements, x) {\n  const time = xToTime(x);\n  if (time <= elements[0].startTime) {\n    return 0;\n  }\n  for (let i = 1; i < elements.length - 1; i++) {\n    if (time > elements[i].endTime && time < elements[i + 1].startTime) {\n      return i + 1;\n    }\n  }\n  if (time >= elements[elements.length - 1].endTime) {\n    return elements.length;\n  }\n}\n\nexport function isIntersect(element1, element2) {\n  const { startTime: s1, endTime: e1 } = element1;\n  const { startTime: s2, endTime: e2 } = element2;\n  if (s1 > s2) { // s2在s1左边\n    return (e1 - s2) < (e1 - s1 + e2 - s2);\n  } else {\n    return (e2 - s1) < (e1 - s1 + e2 - s2);\n  }\n}\n\n// \nexport function solveTimeConfict(elements) {\n  const len = elements.length;\n  for (let i = 0; i < len - 1; i++) {\n    const e1 = elements[i];\n    const e2 = elements[i + 1];\n    if (isIntersect(e1, e2)) {\n      e2.startTime = e1.endTime;\n      e2.endTime = e2.startTime + e2.duration;\n    }\n  }\n}\n\nexport function timeLineElementsToPlayerElements(elements) {\n  return elements.filter((element) => {\n    return element.length > 0;\n  }).flat();\n}\n\nexport function getDuration(elements) {\n  const playerElements = timeLineElementsToPlayerElements(elements);\n  let duration = 0;\n  playerElements.forEach(({ endTime }) => {\n    if (endTime > duration) {\n      duration = endTime;\n    }\n  });\n  return duration;\n}\n\nexport function msToTime(ms) {\n  const msInInt = Math.round(ms);\n  const leftMs = msInInt % 1000;\n  const s = Math.floor(msInInt / 1000);\n  const leftS = s % 60;\n  const m = Math.floor(s / 60);\n  const leftM = m % 60;\n  const h = Math.floor(m / 60);\n  return `${h.toString().padStart(2, '0')}:${leftM.toString().padStart(2, '0')}:${leftS.toString().padStart(2, '0')}.${leftMs.toString().padStart(3, '0')}`;\n}","<template>\n  <div class=\"container\">\n    <div class=\"player\">\n      <div class=\"video\" ref=\"videoContainer\"></div>\n      <div class=\"controls\">\n        <div class=\"play-button\" @click=\"playButtonClick\">\n          <svg v-if=\"!isPlaying\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M20.6074 11.3193L7.37206 3.13743C7.10118 2.97052 6.75265 2.95415 6.46676 3.09652C6.17912 3.23888 6 3.51624 6 3.81815V20.1818C6 20.4837 6.17912 20.7611 6.46588 20.9035C6.59647 20.9681 6.73941 21 6.88235 21C7.05353 21 7.22471 20.9534 7.37206 20.8625L20.6074 12.6807C20.8526 12.5285 21 12.2733 21 12C21 11.7267 20.8526 11.4714 20.6074 11.3193Z\" fill=\"currentColor\"></path></svg>\n          <svg v-else width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><rect x=\"14\" y=\"4\" width=\"6\" height=\"16\" rx=\"1\" fill=\"currentColor\"></rect><rect x=\"4\" y=\"4\" width=\"6\" height=\"16\" rx=\"1\" fill=\"currentColor\"></rect></svg>\n        </div>\n        <div class=\"time\">{{time}}</div>\n      </div>\n    </div>\n    <export-dialog v-if=\"exporting\" :player=\"player\" />\n  </div>\n</template>\n\n<script>\nimport Player from '../../classes/player.js';\nimport { EventBus } from '../../utils/event-bus.js';\nimport ExportDialog from './Export';\nimport { msToTime } from '../../utils/common';\n\nexport default {\n  components: { ExportDialog },\n  data() {\n    return {\n      player: null,\n      isPlaying: false,\n      exporting: false,\n      currentTime: 0\n    };\n  },\n  computed: {\n    time() {\n      return msToTime(this.currentTime);\n    }\n  },\n  mounted() {\n    const playerConfig = {\n      width: 640,\n      height: 360,\n      elements: [],\n      onCurrentTimeChange: (currentTime) => {\n        this.currentTime = currentTime;\n        EventBus.$emit('setCurrentTimeToTimeLine', currentTime);\n      },\n      onEnd: () => {\n        this.isPlaying = false;\n      }\n    };\n    this.player = new Player(playerConfig);\n    this.player.setCurrentTime(0);\n    this.player.attachTo(this.$refs['videoContainer']);\n\n    EventBus.$on('addElement', (elements, element) => {\n      this.add(element);\n      this.update(elements);\n      this.player.renderFrame(true);\n    });\n    EventBus.$on('removeElement', (id) => {\n      this.remove(id);\n      this.player.renderFrame(true);\n    });\n    EventBus.$on('setCurrentTimeToPlayer', (currentTime) => {\n      this.currentTime = currentTime;\n      this.player.setCurrentTime(currentTime);\n    });\n    EventBus.$on('exportVideo', () => {\n      this.exporting = true;\n    });\n    EventBus.$on('exportClose', () => {\n      this.exporting = false;\n    });\n  },\n  methods: {\n    add(element) {\n      this.player.addElement(element);\n    },\n    remove(id) {\n      this.player.removeElement(id);\n    },\n    update(elements) {\n      elements.filter((element) => {\n        return element.length > 0;\n      }).forEach((elements, index) => {\n        elements.forEach(({ id, startTime, endTime }) => {\n          this.player.updateZIndex(id, index);\n          this.player.updateTimes(id, startTime, endTime);\n        });\n      });\n    },\n    playButtonClick() {\n      if (!this.isPlaying) {\n        this.isPlaying = true;\n        this.player.play();\n      } else {\n        this.isPlaying = false;\n        this.player.pause();\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  display: flex;\n  flex-grow: 1;\n  justify-content: center;\n  align-items: center;\n}\n.player {\n  width: 640px;\n  height: 360px;\n  position: relative;\n  top: -20px;\n}\n.video {\n  width: 100%;\n  height: 100%;\n}\n.controls {\n  position: absolute;\n  bottom: -40px;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.play-button {\n  cursor: pointer;\n  color: rgb(244, 244, 244);\n  display: flex;\n}\n.play-button:hover {\n  color: white;\n}\n.cover {\n  width: 100%;\n  height: 100%;\n}\n.time {\n  color: white;\n  padding-left: 20px;\n  text-align: left;\n  width: 120px;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Player.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Player.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Player.vue?vue&type=template&id=e317af16&scoped=true&\"\nimport script from \"./Player.vue?vue&type=script&lang=js&\"\nexport * from \"./Player.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Player.vue?vue&type=style&index=0&id=e317af16&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e317af16\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"inner-container\"},[_c('div',{staticClass:\"scroll-area\",style:({ width: _vm.scrollWidth + 'px' }),on:{\"!click\":function($event){return _vm.timeLineClick($event)}}},[_c('anchor',{attrs:{\"currentTime\":_vm.currentTime}}),_c('div',{staticClass:\"time-rule\"},_vm._l((Array(_vm.duration)),function(item,index){return _c('div',{key:index,staticClass:\"one-second\"},[_vm._v(_vm._s(index))])}),0),_c('div',{staticClass:\"drop-zone-list\"},_vm._l((_vm.list),function(item,index){return _c('div',{key:item ? item.id : index,class:_vm.getClasses(index),on:{\"mouseover\":_vm.dropZoneMouseOver}},[_vm._l((item),function(subItem,index2){return [_c('div',{key:subItem.id,class:_vm.getElementClasses(subItem),style:(_vm.getElementStyle(subItem)),on:{\"click\":function($event){return _vm.elementClick(subItem.id)}}},[_vm._v(\" \"+_vm._s(subItem.name)+\" \")]),(_vm.isAdjacent(item, index2))?_c('div',{key:'transition_' + subItem.id,class:_vm.getTransitionClasses('transition_' + subItem.id),style:(_vm.getTransitionStyle(subItem)),attrs:{\"data-id\":'transition_' + subItem.id}}):_vm._e()]})],2)}),0)],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"anchor\",style:({ left: _vm.left })},[_c('svg',{attrs:{\"width\":\"12\",\"height\":\"14\",\"viewBox\":\"0 0 12 14\",\"fill\":\"none\",\"xmlns\":\"http://www.w3.org/2000/svg\"}},[_c('path',{attrs:{\"d\":\"M0 1.16667V7.67376C0 7.98888 0.127471 8.2906 0.353409 8.51026L5.18674 13.2093C5.63955 13.6496 6.36045 13.6496 6.81326 13.2093L11.6466 8.51026C11.8725 8.2906 12 7.98888 12 7.67376V1.16667C12 0.522335 11.4777 0 10.8333 0H1.16667C0.522335 0 0 0.522334 0 1.16667Z\",\"fill\":\"white\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"anchor\" :style=\"{ left: left }\">\n    <svg width=\"12\" height=\"14\" viewBox=\"0 0 12 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0 1.16667V7.67376C0 7.98888 0.127471 8.2906 0.353409 8.51026L5.18674 13.2093C5.63955 13.6496 6.36045 13.6496 6.81326 13.2093L11.6466 8.51026C11.8725 8.2906 12 7.98888 12 7.67376V1.16667C12 0.522335 11.4777 0 10.8333 0H1.16667C0.522335 0 0 0.522334 0 1.16667Z\" fill=\"white\"></path></svg>\n  </div>\n</template>\n\n<script>\nimport { WidthPerSecond } from '../../constants/common';\nexport default {\n  props: ['currentTime'],\n  computed: {\n    left() {\n      return `${this.currentTime / 1000 * WidthPerSecond + 18}px`;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.anchor {\n  position: absolute;\n  top: 10px;\n  bottom: 10px;\n  width: 2px;\n  pointer-events: none;\n  z-index: 4;\n}\n.anchor svg {\n  transform: translateX(-5px);\n}\n.anchor::after {\n  position: absolute;\n  top: 17px;\n  bottom: 0px;\n  content: \"\";\n  width: 2px;\n  transform: translateX(-50%);\n  background: rgb(255, 255, 255);\n  box-shadow: rgb(28 28 40 / 50%) 0px 5px 15px, rgb(28 28 40 / 20%) 0px 5px 35px, rgb(28 28 40 / 10%) 0px 5px 45px;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Anchor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Anchor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Anchor.vue?vue&type=template&id=29de2020&scoped=true&\"\nimport script from \"./Anchor.vue?vue&type=script&lang=js&\"\nexport * from \"./Anchor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Anchor.vue?vue&type=style&index=0&id=29de2020&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"29de2020\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"container\">\n    <div class=\"inner-container\">\n      <div :style=\"{ width: scrollWidth + 'px' }\" class=\"scroll-area\" @click.capture=\"timeLineClick\">\n        <anchor :currentTime=\"currentTime\"/>\n        <div class=\"time-rule\">\n          <div v-for=\"(item, index) in Array(duration)\"\n            :key=\"index\"\n            class=\"one-second\"\n          >{{index}}</div>\n        </div>\n        <div class=\"drop-zone-list\">\n          <div v-for=\"(item, index) in list\" \n            :key=\"item ? item.id : index\"\n            :class=\"getClasses(index)\"\n            @mouseover=\"dropZoneMouseOver\"\n          >\n            <template v-for=\"(subItem, index2) in item\">\n              <div \n                :key=\"subItem.id\" \n                :class=\"getElementClasses(subItem)\"\n                :style=\"getElementStyle(subItem)\"\n                @click=\"elementClick(subItem.id)\"\n              >\n                {{subItem.name}}\n              </div>\n              <div v-if=\"isAdjacent(item, index2)\"\n                :class=\"getTransitionClasses('transition_' + subItem.id)\"\n                :key=\"'transition_' + subItem.id\"\n                :data-id=\"'transition_' + subItem.id\"\n                :style=\"getTransitionStyle(subItem)\"\n              >\n              </div>\n            </template>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { EventBus } from '../../utils/event-bus';\nimport { WidthPerSecond, DRAG_STATUS, ElementType } from '../../constants/common';\nimport { \n  geneElementInfo, \n  getDuration, \n  solveTimeConfict, \n  getInsertIndex,\n  geneTransitionInfo\n} from '../../utils/common';\nimport Anchor from './Anchor';\n\nexport default {\n  components: { Anchor },\n  data() {\n    return {\n      list: [[]], // 实际存储的数据\n      overIndex: -1,\n      status: DRAG_STATUS.UNKNOWN,\n\n      transitionId: '',\n\n      // 放置位置\n      offsetX: 0,\n      offsetY: 0,\n\n      currentTime: 0,\n\n      activeId: null\n    };\n  },\n  computed: {\n    duration() {\n      return 60;\n    },\n    scrollWidth() {\n      return this.duration * WidthPerSecond + 18 * 2;\n    }\n  },\n  methods: {\n    getClasses(itemIndex) {\n      const { status, overIndex, list } = this;\n      const result = ['drop-zone'];\n      if (status === DRAG_STATUS.DRAGGING && !list[itemIndex].length) {\n        result.push('prepare');\n      } else if (status === DRAG_STATUS.DRAG_OVER) {\n        if (overIndex === itemIndex) {\n          result.push('hover');\n        } else if (!list[itemIndex].length) {\n          result.push('prepare');\n        }\n      }\n      return result;\n    },\n    getTransitionClasses(transitionId) {\n      const { status } = this;\n      const result = ['transition-drop-zone'];\n      if (status === DRAG_STATUS.TRANSITION_DRAGGING) {\n        result.push('prepare');\n      } else if (status === DRAG_STATUS.TRANSITION_DRAG_OVER && \n        transitionId === this.transitionId) {\n        result.push('hover');\n      }\n      return result;\n    },\n    getTransitionStyle(element) {\n      return { left: element.endTime / 1000 * WidthPerSecond + 'px' };\n    },\n    findOverElementIndex(element) {\n      const dropZones = Array.from(document.querySelectorAll('.drop-zone'));\n      return dropZones.indexOf(element);\n    },\n    async add(data, position) {\n      const { overIndex, list, offsetX: x, offsetY: y } = this;\n      const element = await geneElementInfo(data, position, { x, y });\n      const item = list[overIndex];\n      if (!item.length) {\n        list.splice(overIndex, 1, [], [element], []);\n      } else {\n        const insertIndex = getInsertIndex(item, x);\n        item.splice(insertIndex, 0, element);\n        solveTimeConfict(item);\n      }\n      this.activeId = element.id;\n      EventBus.$emit('addElement', list, element);\n    },\n    addTransition(data) {\n      const { list, transitionId } = this;\n      const element1Id = transitionId.replace('transition_', '');\n      let element1, element2;\n      for (let i = 0; i < list.length; i++) {\n        const items = list[i];\n        for (let j = 0; j < items.length; j++) {\n          if (items[j].id === element1Id) {\n            element1 = items[j];\n            element2 = items[j + 1];\n            const transition = geneTransitionInfo(data, element1, element2);\n            items.splice(j + 1, 0, transition);\n            EventBus.$emit('addElement', list, transition);\n            this.activeId = transition.id;\n            return;\n          }\n        }\n      }\n    },\n    remove() {\n      const { list } = this;\n      for (let i = 0; i < list.length; i++) {\n        const elements = list[i];\n        for (let j = 0; j < elements.length; j++) {\n          const element = elements[j];\n          if (element.id === this.activeId) {\n            if (elements[j + 1]?.type === ElementType.TRANSITION) {\n              elements.splice(j, 2);\n            } else if (elements[j - 1]?.type === ElementType.TRANSITION) {\n              elements.splice(j - 1, 2);\n            } else {\n              elements.splice(j, 1);\n            }\n            if (!elements.length && list.length !== 1) {\n              list.splice(i, 2);\n            }\n          }\n        }\n      }\n    },\n    dropZoneMouseOver(e) {\n      const { offsetX, offsetY } = e;\n      this.offsetX = offsetX;\n      this.offsetY = offsetY;\n    },\n    getElementClasses(element) {\n      const { activeId } = this;\n      const result = ['element'];\n      if (activeId === element.id) {\n        result.push('active');\n      }\n      if (element.type === ElementType.TRANSITION) {\n        result.push('transition');\n      }\n      return result;\n    },\n    getElementStyle(element) {\n      const { startTime, endTime } = element;\n      return { \n        left: `${startTime / 1000 * WidthPerSecond}px`, \n        width: `${(endTime - startTime) / 1000 * WidthPerSecond}px`\n      }\n    },\n    timeLineClick(e) {\n      const rect = e.currentTarget.getBoundingClientRect(),\n        offsetX = e.clientX - rect.left;\n      const currentTime = (offsetX - 18) / WidthPerSecond * 1000;\n      const duration = getDuration(this.list);\n      this.currentTime = Math.min(Math.max(0, currentTime), duration);\n      EventBus.$emit('setCurrentTimeToPlayer', this.currentTime);\n    },\n    elementClick(id) {\n      this.activeId = id;\n    },\n    isAdjacent(elements, index) {\n      const element1 = elements[index];\n      const element2 = elements[index + 1];\n      if (\n        element1 && \n        element2 &&\n        [ElementType.VIDEO, ElementType.IMAGE].includes(element1.type) &&\n        [ElementType.VIDEO, ElementType.IMAGE].includes(element2.type)\n      ) {\n        if (Math.abs(element1.endTime - element2.startTime) <= 10e-6) {\n          return true;\n        }\n      }\n      return false;\n    }\n  },\n  mounted() {\n    EventBus.$on('dragging', () => {\n      this.status = DRAG_STATUS.DRAGGING;\n      this.overIndex = -1;\n    });\n    EventBus.$on('dragOver', (element) => {\n      this.status = DRAG_STATUS.DRAG_OVER;\n      this.overIndex = this.findOverElementIndex(element);\n    });\n    EventBus.$on('dragCancelled', () => {\n      this.status = DRAG_STATUS.UNKNOWN;\n      this.overIndex = -1;\n    });\n    EventBus.$on('dragged', ({ data, position }) => {\n      window.setTimeout(() => {\n        this.add(data, position);\n        this.status = DRAG_STATUS.UNKNOWN;\n        this.overIndex = -1;\n      }, 100);\n    });\n\n    // transition \n    EventBus.$on('transitionDragging', () => {\n      this.status = DRAG_STATUS.TRANSITION_DRAGGING;\n    });\n    EventBus.$on('transitionDragOver', (element) => {\n      this.status = DRAG_STATUS.TRANSITION_DRAG_OVER;\n      this.transitionId = element.getAttribute('data-id');\n    });\n    EventBus.$on('transitionDragCancelled', () => {\n      this.status = DRAG_STATUS.UNKNOWN;\n    });\n    EventBus.$on('transitionDragged', ({ data, position }) => {\n      window.setTimeout(() => {\n        this.addTransition(data);\n        this.status = DRAG_STATUS.UNKNOWN;\n      }, 100);\n    });\n\n    EventBus.$on('setCurrentTimeToTimeLine', (currentTime) => {\n      this.currentTime = currentTime;\n    });\n    document.addEventListener('keyup', (e) => {\n      if (e.key === 'Backspace' && this.activeId) {\n        EventBus.$emit('removeElement', this.activeId);\n        this.remove();\n      }\n    });\n  }\n}\n</script>\n\n<style scoped>\n.inner-container {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  overflow: auto;\n}\n.scroll-area {\n  display: flex;\n  align-items: center;\n  height: 100%;\n  position: relative;\n}\n.time-rule {\n  position: absolute;\n  top: 10px;\n  left: 18px;\n  right: 18px;\n  height: 20px;\n  display: flex;\n  flex-wrap: wrap;\n  overflow: hidden;\n}\n.one-second {\n  width: 40px;\n  height: 20px;\n  border-top: 1px solid #30313a;\n  border-left: 1px solid #30313a;\n  font-size: 12px;\n  color: #525257;\n  padding: 5px 0 0 5px;\n  box-sizing: border-box;\n  text-align: left;\n}\n.one-second:last-child {\n  border-right: 1px solid #30313a;\n}\n</style>\n\n<style scoped>\n.container {\n  background-color: #17171e;\n  padding: 35px 18px 15px;\n  height: 450px;\n  box-sizing: border-box;\n  display: flex;\n  flex-shrink: 0;\n  align-items: center;\n  position: relative;\n}\n.drop-zone-list {\n  flex-grow: 1;\n  margin: 0 18px;\n}\n.drop-zone {\n  border-radius: 5px;\n  overflow: hidden;\n  border: none;\n  transition: all 0.5s;\n  margin: 4px 0;\n  position: relative;\n}\n.drop-zone:nth-child(even) {\n  height: 30px;\n  background-color: #1c1d26;\n}\n.drop-zone.hover {\n  background-color: #1c1d26;\n  height: 30px;\n}\n.drop-zone.prepare {\n  height: 10px;\n  background: transparent;\n}\n.drop-zone:only-child {\n  border: 2px dashed rgb(60, 60, 72);\n  height: 60px;\n}\n.drop-zone .element {\n  border-radius: 5px;\n  position: absolute;\n  top: 0;\n  border: none;\n  background-color: rgb(118, 106, 246);\n  height: 30px;\n  line-height: 30px;\n  padding: 0 15px;\n  text-align: left;\n  color: white;\n  overflow: hidden;\n  transition: width 0.3s, background-color 0.3s, box-shadow 0.3s;\n  cursor: default;\n  width: 10px;\n  text-overflow: ellipsis;\n  box-sizing: border-box;\n}\n.drop-zone .element:hover {\n  background-color: rgb(141, 127, 246);\n}\n.drop-zone .element.active {\n  box-shadow: rgb(69 211 174) 0px 0px 0px 2px inset;\n  cursor: move;\n}\n.drop-zone .element.transition {\n  background: rgba(47, 166, 143, 1);\n  opacity: 0.5;\n  z-index: 3;\n}\n\n.transition-drop-zone {\n  position: absolute;\n  top: 0;\n  height: 30px;\n  transition: all 0.3s;\n  box-sizing: border-box;\n  z-index: 5;\n  transform-origin: center center;\n  width: 100px;\n  transform: translateX(-50%);\n  opacity: 0;\n  background: rgba(47, 166, 143, 1);\n  box-sizing: border-box;\n}\n.transition-drop-zone.prepare {\n  opacity: 0.5;\n}\n.transition-drop-zone.hover {\n  opacity: 1;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimeLine.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimeLine.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TimeLine.vue?vue&type=template&id=6b5612c0&scoped=true&\"\nimport script from \"./TimeLine.vue?vue&type=script&lang=js&\"\nexport * from \"./TimeLine.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TimeLine.vue?vue&type=style&index=0&id=6b5612c0&scoped=true&lang=css&\"\nimport style1 from \"./TimeLine.vue?vue&type=style&index=1&id=6b5612c0&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6b5612c0\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[(_vm.currentTab === 'add')?[_c('file-upload',{attrs:{\"accept\":\"video/*, image/png, image/jpeg, image/jpg\"},on:{\"input-file\":_vm.inputFile}},[(_vm.isTranscode)?_c('div',{staticClass:\"transcode-tip\"},[_vm._v(\" 转码中，请稍候... \")]):_vm._e()])]:_vm._l((_vm.assets[_vm.currentTab]),function(item){return _c('div',{key:item.name,staticClass:\"card\"},[_c('div',{staticClass:\"frame\"},[_c('div',{staticClass:\"element\",on:{\"mousedown\":function($event){return _vm.mouseDown($event, item)},\"mouseup\":function($event){return _vm.mouseUp($event, item)}}},[_vm._v(\" \"+_vm._s(item.name)+\" \")])]),_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(item.name))])])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container\">\n    <template v-if=\"currentTab === 'add'\">\n      <file-upload accept=\"video/*, image/png, image/jpeg, image/jpg\" @input-file=\"inputFile\">\n        <div v-if=\"isTranscode\" class=\"transcode-tip\">\n          转码中，请稍候...\n        </div>\n      </file-upload>\n    </template>\n    <template v-else>\n      <div v-for=\"item in assets[currentTab]\"\n        :key=\"item.name\"\n        class=\"card\"\n      >\n        <div class=\"frame\">\n          <div class=\"element\" @mousedown=\"mouseDown($event, item)\" @mouseup=\"mouseUp($event, item)\">\n            {{item.name}}\n          </div>\n        </div>\n        <div class=\"title\">{{item.name}}</div>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nimport { EventBus } from '../../utils/event-bus';\nimport VueUploadComponent from 'vue-upload-component';\nimport { ElementType, TransitionType, OverlayType } from '../../constants/common';\nimport { getMediaInfo, extractVideoInMP4 } from '../../utils/media';\nimport { loadLottie } from '../../utils/tool';\n\nexport default {\n  components: { FileUpload: VueUploadComponent },\n  data() {\n    return {\n      // 拖拽功能相关\n      element: null,\n      shiftX: 0,\n      shiftY: 0,\n      selectedAsset: null,\n\n      isTranscode: false,\n\n      // 资源展示相关\n      assets: {\n        media: [],\n        transitions: [\n          { name: 'Morph', value: TransitionType.MORPH, type: ElementType.TRANSITION, duration: 2000 },\n          { name: 'Dreamy', value: TransitionType.DREAMY, type: ElementType.TRANSITION, duration: 2000 },\n          { name: 'Fade', value: TransitionType.FADE, type: ElementType.TRANSITION, duration: 2000 }\n        ],\n        overlays: [\n          { name: 'Plunging', value: OverlayType.PLUNGING, type: ElementType.SVG, duration: 2000 }\n        ],\n        lottie: [\n          { name: 'markus', value: './lotties/markus.json', type: ElementType.LOTTIE },\n          { name: 'word', value: './lotties/word.json', type: ElementType.LOTTIE },\n          { name: 'lottieLogo', value: './lotties/lottie-logo.json', type: ElementType.LOTTIE }\n        ]\n      },\n      currentTab: 'add'\n    };\n  },\n  mounted() {\n    EventBus.$on('changeTab', (value) => {\n      this.currentTab = value;\n    });\n  },\n  methods: {\n    async inputFile(file) {\n      if (file) {\n        const type = file.type.indexOf('image') > -1 ? ElementType.IMAGE : ElementType.VIDEO;\n        let value;\n        if (type === ElementType.VIDEO) {\n          value = await file.file.arrayBuffer();\n          const mediaInfo = await getMediaInfo(file, value);\n          if (mediaInfo?.video?.compression !== 'h264') { // 视频需要转换为h264\n            this.isTranscode = true;\n            value = await extractVideoInMP4(file, value);\n            this.isTranscode = false;\n          }\n        } else {\n          value = file.file;\n        }\n        this.assets.media.push({\n          name: file.name,\n          value: value,\n          type: type\n        });\n        this.currentTab = 'media';\n        EventBus.$emit('changeTab2Media', 'media');\n      }\n    },\n    mouseDown(e, element) {\n      const { target, pageX, pageY, clientX, clientY } = e;\n      this.element = target;\n      this.shiftX = clientX - this.element.getBoundingClientRect().left;\n      this.shiftY = clientY - this.element.getBoundingClientRect().top;\n      this.element.style.position = 'absolute';\n      this.element.style.zIndex = 1000;\n      this.moveAt(pageX, pageY);\n      this.selectedAsset = element;\n      document.addEventListener('mousemove', this.mouseMove);\n    },\n    moveAt(pageX, pageY) {\n      const { element, shiftX, shiftY } = this;\n      element.style.left = pageX - shiftX + 'px';\n      element.style.top = pageY - shiftY + 'px';\n    },\n    mouseMove(e) {\n      const { pageX, pageY, clientX, clientY } = e;\n      this.moveAt(pageX, pageY);\n      this.element.hidden = true;\n      const elemBelow = document.elementFromPoint(clientX, clientY);\n      this.element.hidden = false;\n      if (elemBelow) {\n        if (this.selectedAsset.type === ElementType.TRANSITION) {\n          if (elemBelow.closest('.transition-drop-zone')) {\n            EventBus.$emit('transitionDragOver', elemBelow);\n          } else {\n            EventBus.$emit('transitionDragging', elemBelow);\n          }\n        } else {\n          if (elemBelow.closest('.drop-zone')) {\n            EventBus.$emit('dragOver', elemBelow);\n          } else {\n            EventBus.$emit('dragging', elemBelow);\n          }\n        }\n      }\n    },\n    async mouseUp(e, item) {\n      const { element, mouseMove } = this;\n      const { clientX, clientY, offsetX, offsetY } = e;\n      this.element.hidden = true;\n      const elemBelow = document.elementFromPoint(clientX, clientY);\n      this.element.hidden = false;\n      if (this.selectedAsset.type === ElementType.TRANSITION) {\n        if (elemBelow && elemBelow.closest('.transition-drop-zone')) {\n          EventBus.$emit('transitionDragged', {\n            data: item,\n            position: { x: offsetX, y: offsetY }\n          });\n        } else {\n          EventBus.$emit('transitionDragCancelled');\n        }\n      } else {\n        if (elemBelow && elemBelow.closest('.drop-zone')) {\n          if (this.selectedAsset.type === ElementType.LOTTIE) {\n            const lottieInstance = await loadLottie(item.value);\n            item.value = lottieInstance;\n            item.duration = lottieInstance.totalFrames / lottieInstance.frameRate * 1000;\n          }\n          EventBus.$emit('dragged', {\n            data: item,\n            position: { x: offsetX, y: offsetY }\n          });\n        } else {\n          EventBus.$emit('dragCancelled');\n        }\n      }\n      element.style.position = '';\n      document.removeEventListener('mousemove', mouseMove);\n    }\n  }\n}\n</script>\n\n<style>\n.file-uploads {\n  width: 100px;\n  height: 100px;\n  position: absolute;\n  left: 50%;\n  top: 40%;\n  transform: translate(-50%, -50%);\n  background: rgb(244, 244, 244);\n  border-radius: 100%;\n  overflow: visible !important;\n}\n.transcode-tip {\n  position: absolute;\n  width: 200px;\n  color: white;\n  text-align: center;\n  top: 110px;\n  left: -50px;\n}\n.file-uploads::before {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 50px;\n  height: 4px;\n  background: #1c1d26;\n  border-radius: 2px;\n}\n.file-uploads::after {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  height: 50px;\n  width: 4px;\n  background: #1c1d26;\n  border-radius: 2px;\n}\n.file-uploads label {\n  cursor: pointer;\n}\n.file-uploads:hover {\n  background: white;\n}\n</style>\n\n<style scoped>\n.container {\n  display: flex;\n  flex-wrap: wrap;\n  overflow-x: hidden;\n  overflow-y: auto;\n  padding: 24px;\n  max-width: 40%;\n  align-content: flex-start;\n  min-width: 513px;\n  box-sizing: border-box;\n}\n.card {\n  width: 135px;\n  max-width: 100%;\n  margin-right: 20px;\n  margin-bottom: 20px;\n  display: flex;\n  flex-direction: column;\n  height: 95px;\n}\n.frame {\n  width: 135px;\n  height: 75px;\n}\n.title {\n  color: #e5e6f1;\n  font-size: .75rem;\n  opacity: .5;\n  padding: 4px 0;\n  font-kerning: auto;\n  text-rendering: optimizeLegibility;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  text-align: left;\n}\n.element {\n  width: 135px;\n  height: 75px;\n  line-height: 75px;\n  border-radius: 5px;\n  background-color: #000;\n  color: #fff;\n  font-size: 18px;\n  cursor: move;\n  user-select: none;\n  overflow: hidden;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Assets.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Assets.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Assets.vue?vue&type=template&id=0ff255bb&scoped=true&\"\nimport script from \"./Assets.vue?vue&type=script&lang=js&\"\nexport * from \"./Assets.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Assets.vue?vue&type=style&index=0&lang=css&\"\nimport style1 from \"./Assets.vue?vue&type=style&index=1&id=0ff255bb&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0ff255bb\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"editor\">\n    <side-menu />\n    <div class=\"right\">\n      <div class=\"toolbar-container\">\n        <div class=\"toolbar\">\n          <div class=\"left\"></div>\n          <button class=\"export-button\" @click=\"exportClick\">\n            导出\n          </button>\n        </div>\n      </div>\n      <div class=\"top\">\n        <assets />\n        <player />\n      </div>\n      <time-line />\n    </div>\n  </div>\n</template>\n\n<script>\nimport SideMenu from './SideMenu';\nimport Player from './Player';\nimport TimeLine from './TimeLine';\nimport Assets from './Assets';\nimport { EventBus } from '../../utils/event-bus';\n\nexport default {\n  components: {\n    SideMenu, Player, TimeLine, Assets\n  },\n  methods: {\n    exportClick() {\n      EventBus.$emit('exportVideo');\n    }\n  }\n}\n</script>\n\n<style>\nbody {\n  overscroll-behavior-x: none;\n}\n* {\n  user-select: none;\n  -webkit-user-select: none;\n}\n::-webkit-scrollbar {\n  height: 10px;\n  width: 10px;\n}\n::-webkit-scrollbar-corner {\n  background-color: rgb(23, 23, 30);\n}\n::-webkit-scrollbar-thumb {\n  background-color: rgb(60, 60, 72);\n  box-shadow: none;\n  border-radius: 95px;\n}\n::-webkit-scrollbar-track {\n  background-color: rgb(28, 28, 38);\n  box-shadow: none;\n  content: \"\";\n}\n</style>\n\n<style scoped>\n.editor {\n  height: 100vh;\n  display: flex;\n}\n.top {\n  display: flex;\n  flex-direction: row;\n}\n.toolbar-container {\n  height: 64px;\n  padding: 24px 24px 0 24px;\n}\n.toolbar {\n  display: flex;\n}\n.toolbar .left {\n  flex: 1 1 0%;\n}\n.export-button {\n  text-align: inherit;\n  border: none;\n  font-variant: inherit;\n  font-stretch: inherit;\n  line-height: inherit;\n  font-family: inherit;\n  cursor: pointer;\n  font-style: normal;\n  font-weight: 600;\n  font-size: 16px;\n  color: white;\n  background: rgb(102, 93, 195);\n  border-radius: 20px;\n  padding: 10px 30px;\n  height: 40px;\n  display: flex;\n  -webkit-box-pack: center;\n  justify-content: center;\n  -webkit-box-align: center;\n  align-items: center;\n  transition: all 100ms ease-in-out 0s;\n  outline: none;\n}\n.export-button:hover {\n  background: rgb(125, 111, 205);\n}\n.right {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  justify-content: space-between;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=e342dd48&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&lang=css&\"\nimport style1 from \"./Index.vue?vue&type=style&index=1&id=e342dd48&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e342dd48\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <Editor />\n  </div>\n</template>\n\n<script>\nimport Editor from './components/editor/Index'\n\nexport default {\n  name: 'App',\n  components: {\n    Editor\n  }\n}\n</script>\n\n<style>\nbody {\n  margin: 0;\n  padding: 0;\n  background-color: #1c1c26;\n}\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=3fa08ff4&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Assets.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Anchor.vue?vue&type=style&index=0&id=29de2020&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimeLine.vue?vue&type=style&index=0&id=6b5612c0&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=style&index=0&id=e4cf187a&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimeLine.vue?vue&type=style&index=1&id=6b5612c0&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Assets.vue?vue&type=style&index=1&id=0ff255bb&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=1&id=e342dd48&scoped=true&lang=css&\""],"sourceRoot":""}